{"version":3,"mappings":"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","names":["tryDecodeUriComponent_","component","fallback","decodeURIComponent","e","regex","env","self","cdnProxyRegex","RegExp","getMetaUrl","name","metaEl","urls","thirdParty","thirdPartyFrameHost","thirdPartyFrameRegex","cdn","localhostRegex","errorReporting","betaErrorReporting","localDev","trustedViewerHosts","geoApi","user","dev","userForEmbed","logs","Error","userAssert","shouldBeTrueish","opt_message","opt_1","opt_2","opt_3","opt_4","opt_5","opt_6","opt_7","opt_8","opt_9","dict","opt_initial","c","v","a","ad","removeFragment","url","index","getExperimentToggles","win","experimentsString","LOCAL_STORAGE_KEY","tokens","toggles","Object","i","getExistingServiceForDocInEmbedScope","element","document","topWin","isEmbed","g","experimentId","frequency","Math","Array","allowed","meta","optedInExperiments","params","queryString","match","value","param","parseQueryString_","ampdocFieExperimentOn","experimentToggles","A","b","B","ampdoc","getAmpdoc","getServiceForDocOrNullInternal","holder","getAmpdocServiceHolder","isServiceRegistered","id","getServiceInternal","getService","getServiceForDoc","elementOrAmpDoc","nodeOrDoc","defaultView","getAmpdocService","services","s","getServices","service","closest","callback","el","opt_stopAt","closestAncestorElementBySelector","selector","matcher","matches","optsSupported","internalListenImplementation","listener","detectEvtListenerOptsSupport","localElement","eventType","event","opt_evtListenerOpts","capture","undefined","options","err","toggle","opt_display","whenLoadedAndVisiblePromise_","Promise","loadPromise","getAmpDoc","whenFirstVisible","insertIframe_","mutateElement","iframe","createElement","iframeSrc_","appendChild","maybeInstallUrlRewrite_","isSingleDoc","urlService","getUrlService_","winUrl","urlMatch","getAttribute","shellUrl","urlMatchExpr","urlRewriter_","UrlRewriter_","waitToPreloadShell_","then","preloadShell_","loaded","AmpInstallServiceWorker","AMP","constructor","super","this","isSafari_","Services","buildCallback","src","install","error","TAG","iframeSrc","origin","docInfo","get","sourceUrl","canonicalUrl","urlMatchExpr_","shellUrl_","urlService_","shellLoc_","parse","handle_","bind","target","tgtLoc","pathname","test","encodeURIComponent","registration","installingSw","evt","performServiceWorkerOptimizations","sendAmpScriptToSwOnFirstVisit","prefetchOutgoingLinks","ampScriptsUsed","item","startsWith","prefix","string","script","activeSW","JSON","type","payload","links","map","call","link","supportsPrefetch","linkTag","doc","fakeLink"],"sources":["src/url-try-decode-uri-component.js","src/url-parse-query-string.js","src/config.js","src/log.js","src/utils/object.js","src/url.js","src/experiments.js","src/service.js","src/ampdoc-fie.js","src/services.js","src/dom.js","extensions/amp-install-serviceworker/0.1/amp-install-serviceworker.js","src/event-helper-listen.js","src/event-helper.js","src/style.js","src/string.js"],"file":"amp-install-serviceworker-0.1.mjs","sourceRoot":"https://raw.githubusercontent.com/ampproject/amphtml/2008290323002/"}