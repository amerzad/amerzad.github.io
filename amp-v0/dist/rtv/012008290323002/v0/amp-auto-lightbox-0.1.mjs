(self.AMP=self.AMP||[]).push({n:"amp-auto-lightbox",v:"2008290323002",f:function(AMP,_){let m;class n{constructor(){let a,b;this.promise=new Promise((d,f)=>{a=d;b=f});this.resolve=a;this.reject=b}}function p(a,b=""){try{return decodeURIComponent(a)}catch(d){return b}}let q=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function r(a){return a?Array.prototype.slice.call(a):[]}let t=self.AMP_CONFIG||{},u=("string"==typeof t.cdnProxyRegex?new RegExp(t.cdnProxyRegex):t.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function v(a){if(self.document&&self.document.head&&(!self.location||!u.test(self.location.origin))){var b=self.document.head.querySelector(`meta[name="${a}"]`);b&&b.getAttribute("content")}}t.cdnUrl||v("runtime-host");t.geoApiUrl||v("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};(function(a){return a||{}})({c:!0,v:!0,a:!0,ad:!0});function w(a){let b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(f){}let d=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(let b=0;b<d.length;b++)0!=d[b].length&&("-"==d[b][0]?a[d[b].substr(1)]=!1:a[d[b]]=!0);return a}function x(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return y(a,b)}function B(a,b){var d=C(a);d=D(d);return y(d,b)}function C(a){return a.nodeType?x((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function D(a){a=C(a);return a.isSingleDoc()?a.win:a}function y(a,b){E(a,b);{let b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});a=b}b=a[b];b.obj||(b.obj=new b.ctor(b.context),b.ctor=null,b.context=null,b.resolve&&b.resolve(b.obj));return b.obj}function E(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}
/*
    https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function F(a,b){for(;a&&void 0!==a;a=a.parentElement)if(b(a))return a;return null}function G(a){return a.closest?a.closest("a[href],amp-script,amp-story,button,amp-lightbox,amp-carousel,[placeholder],[data-amp-auto-lightbox-disable],amp-selector [option],[subscriptions-action]"):F(a,a=>{{let b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;a=b?b.call(a,"a[href],amp-script,amp-story,button,amp-lightbox,amp-carousel,[placeholder],[data-amp-auto-lightbox-disable],amp-selector [option],[subscriptions-action]"):!1}return a})}function H(a){var b=a.tagName;4>b.length||b.lastIndexOf("AMP-",0);if(a.createdCallback)return Promise.resolve(a);a.__AMP_UPG_PRM||(b=new n,a.__AMP_UPG_PRM=b.promise,a.__AMP_UPG_RES=b.resolve);return a.__AMP_UPG_PRM}/nochunking=1/.test(self.location.hash);(function(){return m?m:m=Promise.resolve(void 0)})();let I={Article:!0,NewsArticle:!0,BlogPosting:!0,LiveBlogPosting:!0,DiscussionForumPosting:!0},J=()=>{},K=/\s+([0-9]+)w(,|[\S\s]*$)/g;function L(a){return B(a,"mutator").mutateElement(a,()=>{a.setAttribute("i-amphtml-auto-lightbox-visited","")})}function M(a){return H(a).then(a=>a.signals().whenSignal("load-end"))}function N(a){return r(a.getRootNode().querySelectorAll('script[type="application/ld+json"]')).map(a=>{try{var b=JSON.parse(a.textContent)}catch(f){b=null}return(b||{})["@type"]}).filter(a=>a)}function O(a){return N(a).some(a=>I[a])}function P(a){let b=b=>!!a.getRootNode().querySelector(b);return b('script[custom-element="amp-lightbox-gallery"]')&&b("[lightbox]:not([i-amphtml-auto-lightbox-visited])")}let Q=0;function R(a,b){return B(a,"mutator").mutateElement(b,()=>{b.setAttribute("lightbox",`i-amphtml-auto-lightbox-${Q++}`)}).then(()=>{x(a.win,"extensions").installExtensionForDoc(a,"amp-lightbox-gallery");b.dispatchCustomEvent("amp-auto-lightbox:newly-set");return b})}function S(a,b){b.map(b=>M(b).then(()=>{var f;if(f=!b.signals().get("unload")){{var g=b.querySelector("img");f=g.naturalWidth;var d=g.naturalHeight,k=f/d;var c=-1;if(g=g.getAttribute("srcset"))for(var h;h=K.exec(g);)h=parseInt(h[1],10),h>c&&(c=h);f=c>f?{naturalWidth:c,naturalHeight:c/k}:{naturalWidth:f,naturalHeight:d};let{naturalWidth:a,naturalHeight:e}=f,{width:l,height:U}=b.getLayoutBox();f=B(b,"viewport");let{width:z,height:A}=f.getSize();f=l*U;d=.25<=f/(z*A);k=a>z||e>A;f=1.2<=a*e/f||k||d}if(f){if(G(b))var e=!1;else{f=b.ownerDocument.defaultView;k=f.__AMP_TOP||(f.__AMP_TOP=f);d=f!=k;c=k;if(c.__AMP__EXPERIMENT_TOGGLES)e=c.__AMP__EXPERIMENT_TOGGLES;else{c.__AMP__EXPERIMENT_TOGGLES=Object.create(null);k=c.__AMP__EXPERIMENT_TOGGLES;if(c.AMP_CONFIG)for(e in c.AMP_CONFIG)g=c.AMP_CONFIG[e],"number"===typeof g&&0<=g&&1>=g&&(k[e]=Math.random()<g);if(c.AMP_CONFIG&&Array.isArray(c.AMP_CONFIG["allow-doc-opt-in"])&&0<c.AMP_CONFIG["allow-doc-opt-in"].length&&(e=c.AMP_CONFIG["allow-doc-opt-in"],g=c.document.head.querySelector('meta[name="amp-experiments-opt-in"]')))for(g=g.getAttribute("content").split(","),h=0;h<g.length;h++)-1!=e.indexOf(g[h])&&(k[g[h]]=!0);Object.assign(k,w(c));if(c.AMP_CONFIG&&Array.isArray(c.AMP_CONFIG["allow-url-opt-in"])&&0<c.AMP_CONFIG["allow-url-opt-in"].length){e=c.AMP_CONFIG["allow-url-opt-in"];c=c.location.originalHash||c.location.hash;g=Object.create(null);if(c)for(var l;l=q.exec(c);)h=p(l[1],l[1]),l=l[2]?p(l[2].replace(/\+/g," "),l[2]):"",g[h]=l;c=g;for(g=0;g<e.length;g++)h=c[`e-${e[g]}`],"1"==h&&(k[e[g]]=!0),"0"==h&&(k[e[g]]=!1)}e=k}e=!!e["ampdoc-fie"];d&&!e?e=E(f,"action")?y(f,"action"):null:(e=C(b),e=D(e),e=E(e,"action")?y(e,"action"):null);e=!e.hasResolvableAction(b,"tap")}f=e}}if(f)return R(a,b)},J))}function T(a,b){if(P(a))var d=0;else d=(d=a.getRootNode().querySelector('meta[property="og:type"]'))?d.getAttribute("content"):void 0,d="article"==d||O(a);d&&(d=r((b||a.win.document).querySelectorAll("amp-img:not([lightbox]):not([i-amphtml-auto-lightbox-visited])")),d.forEach(L),S(a,d))}(a=>{let b=a.ampdoc;b.whenReady().then(()=>{b.getRootNode().addEventListener("amp:dom-update",a=>{T(b,a.target)});T(b)})})(self.AMP)}});