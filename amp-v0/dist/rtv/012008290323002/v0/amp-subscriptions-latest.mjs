(self.AMP=self.AMP||[]).push({n:"amp-subscriptions",v:"2008290323002",f:function(AMP,_){let ca;function p(){return ca?ca:ca=Promise.resolve(void 0)}function da(a){return a?Array.prototype.slice.call(a):[]}let ea=Object.prototype.hasOwnProperty;function t(a){return a||{}}class w{constructor(){let a,b;this.promise=new Promise((c,d)=>{a=c;b=d});this.resolve=a;this.reject=b}}function fa(a,b=""){try{return decodeURIComponent(a)}catch(c){return b}}let ha=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function ia(a){let b=Object.create(null);if(!a)return b;let c;for(;c=ha.exec(a);){let a=fa(c[1],c[1]),f=c[2]?fa(c[2].replace(/\+/g," "),c[2]):"";b[a]=f}return b}let z=self.AMP_CONFIG||{},ja=("string"==typeof z.cdnProxyRegex?new RegExp(z.cdnProxyRegex):z.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function ka(a){if(!self.document||!self.document.head||self.location&&ja.test(self.location.origin))return null;let b=self.document.head.querySelector(`meta[name="${a}"]`);return b&&b.getAttribute("content")||null}let la={thirdParty:z.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:z.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof z.thirdPartyFrameRegex?new RegExp(z.thirdPartyFrameRegex):z.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:z.cdnUrl||ka("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:ja,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:z.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:z.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:z.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:z.geoApiUrl||ka("amp-geo-api")};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};let C=self.__AMP_LOG;function D(){if(!C.user)throw Error("failed to call initLogConstructor");return C.user}function ma(){if(C.dev)return C.dev;throw Error("failed to call initLogConstructor")}function E(a,b,c,d,f){return D().assert(a,b,c,d,f,void 0,void 0,void 0,void 0,void 0,void 0)}class na{constructor(a){this.mb=a;this.M=this.Sa=0;this.ma=Object.create(null)}has(a){return!!this.ma[a]}get(a){let b=this.ma[a];if(b)return b.access=++this.M,b.payload}put(a,b){this.has(a)||this.Sa++;this.ma[a]={payload:b,access:this.M};if(!(this.Sa<=this.mb)){a=this.ma;var c=this.M+1;for(let b in a){let{access:f}=a[b];if(f<c){c=f;var d=b}}void 0!==d&&(delete a[d],this.Sa--)}}}let oa=t({c:!0,v:!0,a:!0,ad:!0});let pa,qa;let ra=/[?&]amp_js[^&]*/,sa=/[?&]amp_gsa[^&]*/,ta=/[?&]amp_r[^&]*/,ua=/[?&]amp_kit[^&]*/,va=/[?&]usqp[^&]*/;function wa(a){return a.origin||F(a.location.href).origin}function F(a){pa||(pa=self.document.createElement("a"),qa=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new na(100)));var b=qa,c=pa;if(b&&b.has(a))a=b.get(a);else{c.href=a;c.protocol||(c.href=c.href);var d={href:c.href,protocol:c.protocol,host:c.host,hostname:c.hostname,port:"0"==c.port?"":c.port,pathname:c.pathname,search:c.search,hash:c.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==d.protocol&&443==d.port)d.port="",d.host=d.hostname;d.origin=c.origin&&"null"!=c.origin?c.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;b&&b.put(a,d);a=d}return a}function xa(a,b){if(b=`${encodeURIComponent("crypt")}=${encodeURIComponent(b)}`){a=a.split("#",2);var c=a[0].split("?",2);b=c[0]+(c[1]?`?${c[1]}&${b}`:`?${b}`);b+=a[1]?`#${a[1]}`:""}else b=a;return b}function ya(a,b){E(null!=a,"%s %s must be available",b,"source");var c=a;"string"==typeof c&&(c=F(c));var d;(d="https:"==c.protocol||"localhost"==c.hostname||"127.0.0.1"==c.hostname)||(c=c.hostname,d=c.length-10,d=0<=d&&c.indexOf(".localhost",d)==d);E(d||/^(\/\/)/.test(a),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,"source",a);return a}function za(a){let b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(d){}let c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(let b=0;b<c.length;b++)0!=c[b].length&&("-"==c[b][0]?a[c[b].substr(1)]=!1:a[c[b]]=!0);return a}function H(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return I(a,b)}function J(a,b){var c=M(a);c=N(c);return I(c,b)}function M(a){return a.nodeType?H((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function N(a){a=M(a);return a.isSingleDoc()?a.win:a}function I(a,b){Aa(a,b);a=Ba(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function Ca(a,b){let c=Da(a,b);if(c)return c;a=Ba(a);a[b]=Ea();return a[b].promise}function Da(a,b){let c=Ba(a)[b];if(c){if(c.promise)return c.promise;I(a,b);return c.promise=Promise.resolve(c.obj)}return null}function Ba(a){let b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function Aa(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}function Ea(){let a=new w,b=a.promise,c=a.resolve,d=a.reject;b.catch(()=>{});return{obj:null,promise:b,resolve:c,reject:d,context:null,ctor:null}}
/*
    https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
let Fa;function Ga(a,b,c){if(b(a))c();else{var d=a.ownerDocument.defaultView;if(d.MutationObserver){let f=new d.MutationObserver(()=>{b(a)&&(f.disconnect(),c())});f.observe(a,{childList:!0})}else{let f=d.setInterval(()=>{b(a)&&(d.clearInterval(f),c())},5)}}}function Ha(a,b){return new Promise(c=>{Ga(a,b,c)})}function Ia(a,b,c=null){c?a.insertBefore(b,c.nextSibling):a.insertBefore(b,a.firstChild)}function Ja(a,b,c){a=a.createElement(b);for(let b in c)a.setAttribute(b,c[b]);return a}function Ka(a,b){for(;a&&void 0!==a;a=a.parentElement)if(b(a))return a;return null}function La(a){return a.closest?a.closest("[subscriptions-action]"):Ka(a,a=>{{let b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;a=b?b.call(a,"[subscriptions-action]"):!1}return a})}function Ma(a){/^[\w-]+$/.test("footer");if(void 0!==Fa)var b=Fa;else{try{let c=a.ownerDocument,d=c.createElement("div"),f=c.createElement("div");d.appendChild(f);b=d.querySelector(":scope div")===f}catch(c){b=!1}b=Fa=b}b?a=a.querySelector("> footer".replace(/^|,/g,"$&:scope ")):(a.classList.add("i-amphtml-scoped"),b="> footer".replace(/^|,/g,"$&.i-amphtml-scoped "),b=a.querySelectorAll(b),a.classList.remove("i-amphtml-scoped"),a=b,a=void 0===a[0]?null:a[0]);return a}function Na(a,b){let c=a.length;for(let d=0;d<c;d++)b(a[d],d)}function Oa(a,b,c){let d;try{d=a.open(b,"_blank",c)}catch(g){ma().error("DOM","Failed to open url on target: ","_blank",g)}var f;if(!(f=d||!1)){f=c||"";var e;"number"!==typeof e&&(e=0);f=e+8>f.length?!1:-1!==f.indexOf("noopener",e)}f||(d=a.open(b,"_top"));return d}function Pa(a){let b=Da(N(a),"amp-analytics-instrumentation");if(b)return b;let c=M(a);return c.waitForBodyOpen().then(()=>{var a=c.win;var b=c.win.document.head;if(b){var e={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(let a=0;a<b.length;a++){var g=b[a];g=g.getAttribute("custom-element")||g.getAttribute("custom-template");e[g]=!0}e=Object.keys(e)}else e=[];return e.includes("amp-analytics")?H(a,"extensions").waitForExtension(a,"amp-analytics"):p()}).then(()=>{var b=c.win;return b.__AMP_EXTENDED_ELEMENTS&&b.__AMP_EXTENDED_ELEMENTS["amp-analytics"]?Ca(N(a),"amp-analytics-instrumentation"):null})}function O(a){return H(a,"timer")}function Qa(a,b,c={}){Pa(a).then(d=>{d&&d.triggerEventForTarget(a,b,c,!1)})}class Ra{constructor(a){this.qb=a;this.Ma=[]}registerEventListener(a){this.Ma.push(a)}serviceEvent(a,b,c,d){this.event(a,Object.assign(t({serviceId:b}),c),d)}event(a,b,c){c=c||t({});let d="subscriptions-action"!==a?a:a+`-${c.action}-${c.status}`;b=b||t({});Qa(this.qb,d,b);for(let d=0;d<this.Ma.length;d++)this.Ma[d](a,b,c)}actionEvent(a,b,c,d){this.serviceEvent("subscriptions-action",a,d,t({action:b,status:c}))}}function Sa(a,b,c){let d=!!self.msCrypto;return Ta((d?self.msCrypto.subtle:self.crypto.subtle).decrypt({name:"AES-GCM",iv:b,tag:d?c.slice(c.byteLength-16):void 0,tagLength:128},a,d?c.slice(0,c.byteLength-16):c)).then(a=>{a=new Uint8Array(a);if("undefined"!==typeof TextDecoder)a=new TextDecoder("utf-8").decode(a);else{a=new Uint8Array(a.buffer||a);var b=Array(a.length);for(let c=0;c<a.length;c++)b[c]=String.fromCharCode(a[c]);a=b.join("");a=decodeURIComponent(escape(a))}return a})}function Ta(a){return"function"==typeof a.then?a:new Promise((b,c)=>{a.oncomplete=()=>{b(a.result)};a.onerror=c})}function Ua(a){a=atob(a);let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}function Va(a,b){if("."==b)return a;b=b.split(".");for(let c=0;c<b.length;c++){let d=b[c];if(d&&a&&void 0!==a[d]&&(null==a||"object"!=typeof a?0:Object.prototype.hasOwnProperty.call(a,d)))a=a[d];else{a=void 0;break}}return a}function P(a,b){try{return JSON.parse(a)}catch(c){return b&&b(c),null}}function Wa(a){if("undefined"!==typeof TextDecoder)return new TextDecoder("utf-8").decode(a);{a=new Uint8Array(a.buffer||a);let b=Array(a.length);for(let c=0;c<a.length;c++)b[c]=String.fromCharCode(a[c]);a=b.join("")}return decodeURIComponent(escape(a))}function Xa(a){return"undefined"!==typeof TextEncoder?new TextEncoder("utf-8").encode(a):Q(unescape(encodeURIComponent(a)))}function Q(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);b[c]=d}return b}function Ya(a,b){if(a.pa)return a.pa;a.pa=a.h.whenReady().then(()=>{let c=Ua(b);return Ta((self.msCrypto?self.msCrypto.subtle:self.crypto.subtle).importKey("raw",c.buffer,"AES-GCM",!0,["decrypt"])).then(b=>{let c=a.h.getRootNode().querySelectorAll("script[ciphertext]"),d=[];Na(c,a=>{var c=a.textContent.replace(/\s+/g,""),f=Ua(c).buffer;c=f.slice(0,12);f=f.slice(12);d.push(Sa(b,c,f).then(b=>{a.outerHTML=b}))});return Promise.all(d)})});return a.pa}class Za{constructor(a){this.h=a;this.pa=null;let b=this.h.getRootNode().querySelector("script[cryptokeys]");this.Ra=null;b&&b.hasAttribute("sha-256-hash")&&(this.Ra=b.getAttribute("sha-256-hash"));this.Ga=b&&P(b.textContent)||null}isDocumentEncrypted(){return!!this.Ga&&0<Object.keys(this.Ga).length}getEncryptedKeys(){return this.Ga}getEncryptedDocumentKey(a){let b=this.getEncryptedKeys();return b?b[a]||null:null}tryToDecryptDocument(a){if(!this.Ra)return Ya(this,a);let b=Xa(a);return crypto.subtle.digest("SHA-256",b).then(b=>da(new Uint8Array(b)).map(a=>{a=a.toString(16);var b=2;if(!(a.length>=b)){b-=a.length;for(var c="0";b>c.length;)c+="0";a=c.slice(0,b)+a}return a}).join("")!=this.Ra?Promise.reject(Error("Invalid Document Key")):Ya(this,a))}}let R;let $a="Webkit webkit Moz moz ms O o".split(" ");function ab(a,b){if(2>b.length?0:0==b.lastIndexOf("--",0))return b;R||(R=Object.create(null));let c=R[b];if(!c){c=b;if(void 0===a[b]){var d=b.charAt(0).toUpperCase()+b.slice(1);a:{for(let b=0;b<$a.length;b++){let c=$a[b]+d;if(void 0!==a[c]){d=c;break a}}d=""}let f=d;void 0!==a[f]&&(c=f)}R[b]=c}return c}function bb(a,b){a=a.style;for(let c in b)a.setProperty(ab(a,c),b[c].toString(),"important")}function S(a,b){void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","")}function cb(a,b){return a.cb=a.cb.then(b)}function db(a,b,c=!0){a.Ca?a.B.replaceChild(b,a.Ca):a.B.appendChild(b);a.Ca=b;if(a.ia)return p();a.ia=!0;return a.ja.mutatePromise(()=>{S(a.B,!0);a.showCloseAction(c)}).then(()=>a.ja.mutatePromise(()=>{bb(a.B,{transform:"translateY(0)"})}).then(()=>a.L.promise(300))).then(()=>{let b;return a.ja.runPromise({measure:()=>{b=a.B.offsetHeight},mutate:()=>{a.V.updatePaddingBottom(b);a.V.addToFixedLayer(a.B,!0)}})})}function eb(a){return a.ia?a.ja.mutatePromise(()=>{bb(a.B,{transform:"translateY(100%)"})}).then(()=>a.L.promise(300)).then(()=>a.ja.mutatePromise(()=>{S(a.B,!1);a.V.updatePaddingBottom(0);a.ia=!1})):p()}class fb{constructor(a){this.h=a;this.ja=H(a.win,"vsync");this.L=O(a.win);this.V=J(a,"viewport");this.ia=!1;this.Ca=null;this.cb=p();a=this.h.win.document;this.B=Ja(a,"amp-subscriptions-dialog",{role:"dialog"});S(this.B,!1);this.Aa=Ja(a,"button",{"class":"i-amphtml-subs-dialog-close-button"});this.showCloseAction(!1);this.B.appendChild(this.Aa);this.Aa.addEventListener("click",()=>{this.close()});this.h.getBody().appendChild(this.B);bb(this.B,{transform:"translateY(100%)"})}getRoot(){return this.B}isVisible(){return this.ia}open(a,b=!0){return cb(this,()=>db(this,a,b))}close(){return cb(this,()=>eb(this))}showCloseAction(a){S(this.Aa,a)}}function gb(a){let b=a.readyState;return"loading"!=b&&"uninitialized"!=b}function hb(a,b){if(gb(a))b(a);else{var c=!1,d=()=>{gb(a)&&!c&&(b(a),c=!0,a.removeEventListener("readystatechange",d))};a.addEventListener("readystatechange",d)}}function jb(a){return new Promise(b=>{hb(a,b)})}class kb{constructor(a){let b=!!a.document;this.xa=b?a:a.defaultView;this.l=b?a.document:a}getWin(){return this.xa}getRootNode(){return this.l}getRootElement(){return this.l.documentElement}getHead(){return this.l.head}getBody(){return this.l.body}isReady(){return gb(this.l)}whenReady(){return jb(this.l)}addToFixedLayer(){return Promise.resolve()}}function lb(a){return 9===a.nodeType||a.document?new kb(a):a}function mb(a){var b=null;let c="";for(let a=0;a<arguments.length;a++){var d=arguments[a];if(d instanceof Error&&!b)a:{b=d;if((d=Object.getOwnPropertyDescriptor(b,"message"))&&d.writable)break a;d=b.stack;let a=Error(b.message);for(let c in b)a[c]=b[c];a.stack=d;b=a}else c&&(c+=" "),c+=d}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function nb(a,b){a.wa&&(b.message?-1===b.message.indexOf(a.wa)&&(b.message=a.wa):b.message=a.wa)}class ob{constructor(a=""){this.wa=a}createError(a){let b=mb.apply(null,Array.prototype.slice.call(arguments));nb(this,b);return b}createExpectedError(a){let b=mb.apply(null,Array.prototype.slice.call(arguments));nb(this,b);b.expected=!0;return b}error(a){throw this.createError.apply(this,arguments)}expectedError(a){throw this.createExpectedError.apply(this,arguments)}}let pb=new ob(self.__AMP_TOP?"​​​":"");class qb{constructor(a,b){let c,d,f;let e=a.indexOf(":");-1!=e?(d=a,c=d.substring(0,e),f=d.substring(e+1),"*"==f&&pb.expectedError("wildcard disallowed")):(c=a,f=d=null);this.Oa=c;this.aa=d;this.tb=f;this.vb=b}getPublicationId(){return this.Oa}getProductId(){return this.aa}getLabel(){return this.tb}isLocked(){return this.vb}}function rb(a){console.log.apply(console,arguments)}function sb(a){if(/swg.debug=1/.test(self.location.hash)){let a=Array.prototype.slice.call(arguments,0);a.unshift("[Subscriptions]");rb.apply(rb,a)}}let T="CreativeWork Article NewsArticle Blog Comment Course HowTo Message Review WebPage".split(" "),tb=new RegExp(T.join("|"));class ub{constructor(a){this.l=lb(a);this.X=null;this.na=new Promise(a=>{this.X=a});this.wb=new vb(this.l);this.ub=new wb(this.l);this.xb=new xb(this.l)}resolveConfig(){Promise.resolve().then(this.check.bind(this));this.l.whenReady().then(this.check.bind(this));return this.na}check(){if(!this.X)return null;let a=this.wb.check();a||(a=this.ub.check());a||(a=this.xb.check());a?(this.X(a),this.X=null):this.l.isReady()&&(this.X(Promise.reject(pb.createError("No config could be discovered in the page"))),this.X=null);sb(a);return a}}function yb(a){return Array.isArray(a)?a:[a]}class zb{constructor(){}checkValue(a,b){return a?this.checkArray(yb(a),b):!1}checkString(a,b){return a?this.checkArray(a.split(/\s+/),b):!1}checkArray(a,b){let c=!1;a.forEach(a=>{c=c||b.includes(a.replace(/^http:\/\/schema.org\//i,""))});return c}}class vb{constructor(a){this.l=a}check(){if(!this.l.getBody())return null;let a=Ab(this.l.getRootNode(),"subscriptions-product-id");if(!a)return null;let b=Ab(this.l.getRootNode(),"subscriptions-accessible-for-free"),c=b&&"false"==b.toLowerCase()||!1;return new qb(a,c)}}function Bb(a,b){a=a[b];return null==a||""===a?null:Array.isArray(a)?a:[a]}function Cb(a,b){let c=Bb(a,b);a=c&&c[0];return null==a||""===a?null:a}class wb{constructor(a){this.l=a;this.da=new zb}check(){if(!this.l.getBody())return null;let a=this.l.isReady(),b=this.l.getRootNode().querySelectorAll('script[type="application/ld+json"]');for(let d=0;d<b.length;d++){let f=b[d];var c;if(!(c=f["__SWG-SEEN__"]||!f.textContent)&&(c=!a)){a:{c=f;do{if(c.nextSibling){c=!0;break a}}while((c=c.parentNode)&&void 0!=c);c=!1}c=!c}if(c)continue;f["__SWG-SEEN__"]=!0;if(!tb.test(f.textContent))continue;let e=this.Va(f);if(e)return e}return null}Va(a){a:{try{var b=JSON.parse(a.textContent);break a}catch(d){}b=void 0}if(!b||!this.da.checkValue(b["@type"],T))return null;a=null;let c=Bb(b,"isPartOf");if(c)for(let b=0;b<c.length&&!(a=this.Ea(c[b]));b++);if(!a)return null;b=Cb(b,"isAccessibleForFree");b=null==b||""===b?!0:"boolean"==typeof b?b:"string"==typeof b&&"false"==b.toLowerCase()?!1:!0;return new qb(a,!b)}Ea(a){return this.da.checkValue(a["@type"],["Product"])?Cb(a,"productID"):null}}function Db(a,b,c){for(var d=b;d&&!d[c];d=d.parentNode)if(d[c]=!0,d.hasAttribute&&d.hasAttribute("itemscope"))return d=d.getAttribute("itemtype"),a.da.checkString(d,T);return!1}function Eb(a,b){let c=b.querySelectorAll("[itemprop='isAccessibleForFree']");for(b=0;c[b];b++){let d=c[b],f=d.getAttribute("content")||d.textContent;if(f&&Db(a,d,"alreadySeenForAccessInfo")){let a=null;"true"==f.toLowerCase()?a=!0:"false"==f.toLowerCase()&&(a=!1);return a}}return null}function Fb(a){let b=null;null!=a.M?b=!a.M:a.l.isReady()&&(b=!1);return null!=a.aa&&null!=b?new qb(a.aa,b):null}class xb{constructor(a){this.l=a;this.aa=this.M=null;this.da=new zb}Ea(a){a=a.querySelectorAll('[itemprop="productID"]');for(let c=0;a[c];c++){var b=a[c];let d=b.getAttribute("content")||b.textContent;b=b.closest("[itemtype][itemscope]");if(!(-1>=b.getAttribute("itemtype").indexOf("http://schema.org/Product"))&&Db(this,b.parentElement,"alreadySeenForProductInfo"))return d}return null}Va(){var a=Fb(this);if(a)return a;let b=Array.prototype.slice.call(this.l.getRootNode().querySelectorAll("[itemscope][itemtype]")).filter(a=>this.da.checkString(a.getAttribute("itemtype"),T));for(let c=0;b[c]&&null==a;c++)a=b[c],null==this.M&&(this.M=Eb(this,a)),this.aa||(this.aa=this.Ea(a)),a=Fb(this);return a}check(){return this.l.getBody()?this.Va():null}}function Ab(a,b){return(a=a.querySelector(`meta[name="${b}"]`))?a.getAttribute("content"):null}class Gb{constructor(a){this.h=a;this.V=J(this.h,"viewport")}getWin(){return this.h.win}getRootNode(){return this.h.getRootNode()}getRootElement(){let a=this.h.getRootNode();return a.documentElement||a.body||a}getHead(){return this.h.getHeadNode()}getBody(){return this.h.isBodyAvailable()?this.h.getBody():null}isReady(){return this.h.isReady()}whenReady(){return this.h.whenReady()}addToFixedLayer(a){return this.V.addToFixedLayer(a,!0)}}let Hb={IS_READY_TO_PAY:"isReadyToPay",SUPPORTS_VIEWER:"supportsViewer"},Ib={};function Jb(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter((function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})));c.push.apply(c,d)}return c}function Kb(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?Jb(Object(c),!0).forEach((function(b){var d=c[b];b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):Jb(Object(c)).forEach((function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))}))}return a}function U(a){return new V({source:"",raw:"",service:a,granted:!1})}function Lb(a){a||(a={});let b=JSON.stringify(a);return new V({source:a.source||"",raw:b,service:"",granted:a.granted||!1,grantReason:a.grantReason,dataObject:a.data||null,decryptedDocumentKey:a.decryptedDocumentKey||null})}class V{constructor(a){let{source:b,raw:c="",service:d,granted:f=!1,grantReason:e="",dataObject:g,decryptedDocumentKey:k}=a;this.raw=c;this.source=b;this.service=d;this.granted=f;this.grantReason=e;this.data=g;this.decryptedDocumentKey=k}json(){return t({source:this.source,service:this.service,granted:this.granted,grantReason:this.grantReason,data:this.data})}jsonForPingback(){return Kb({raw:this.raw},this.json())}isSubscriber(){return this.granted&&"SUBSCRIBER"===this.grantReason}}class Mb{constructor(){this.C=null}add(a){this.C||(this.C=[]);this.C.push(a);return()=>{this.remove(a)}}remove(a){this.C&&(a=this.C.indexOf(a),-1<a&&this.C.splice(a,1))}removeAll(){this.C&&(this.C.length=0)}fire(a){if(this.C){var b=this.C;for(let c=0;c<b.length;c++)(0,b[c])(a)}}getHandlerCount(){return this.C?this.C.length:0}}function Nb(a,b){if(!a.F&&b.granted||a.F&&!a.F.isSubscriber()&&b.isSubscriber())a.F=b}function Ob(a,b,c){return a.getEntitlementPromiseFor(b).then(()=>a.K[b].getSupportedScoreFactor(c))}function W(a){return Object.keys(a.N).length===a.Qa.length}function Pb(a){let b=[];for(let c in a.N)ea.call(a.N,c)&&b.push(a.N[c]);return b}function Qb(a,b,c){c=c.getSupportedScoreFactor(b);return"number"!==typeof c?0:a.ua[b]*Math.min(1,Math.max(-1,c))}function Rb(a,b){let c=a.getLocalPlatform();b.sort((a,b)=>b.weight==a.weight&&a.platform==c?-1:b.weight-a.weight);return b[0].platform}function Sb(a){return a.getAvailablePlatforms().map(b=>({platform:b,weight:Tb(a,b)}))}function Tb(a,b){let c=[0],d=b.getBaseScore();for(let d in a.ua)ea.call(a.ua,d)&&c.push(Qb(a,d,b));return d+c.reduce((a,b)=>a+b)}function Ub(a){let b=a.getAvailablePlatforms().map(a=>{let b=a.getSupportedScoreFactor("supportsViewer");return{platform:a,weight:"number"==typeof b?b:0}});return Rb(a,b)}class Vb{constructor(a,b,c,d){this.K=d||{};this.Qa=a;this.N={};this.Ha={};a.forEach(a=>{this.Ha[a]=new w});this.Na=new Mb;this.fb=new Mb;this.W=this.Y=this.F=this.I=null;this.fa=[];this.Ia=c;this.ua=Object.assign(Ib,b)}resolvePlatform(a,b){this.K[a]=b;this.fb.fire({serviceId:a})}resetPlatformStore(){for(let a in this.K)this.K[a].reset();return new Vb(this.Qa,this.ua,this.Ia,this.K)}onPlatformResolves(a,b){let c=this.K[a];c?b(c):this.fb.add(c=>{c.serviceId===a&&b(this.getPlatform(a))})}getPlatform(a){return this.K[a]}getLocalPlatform(){return this.getPlatform("local")}getAvailablePlatforms(){let a=[];for(let b in this.K)a.push(this.K[b]);return a}onChange(a){this.Na.add(a)}resolveEntitlement(a,b){b&&(b.service=a);this.N[a]=b;let c=this.Ha[a];c&&c.resolve(b);-1!=this.fa.indexOf(a)&&this.fa.splice(this.fa.indexOf(a));b.granted&&Nb(this,b);this.Na.fire({serviceId:a,entitlement:b})}getResolvedEntitlementFor(a){return this.N[a]}getEntitlementPromiseFor(a){return this.Ha[a].promise}getScoreFactorStates(){let a=t({});return Promise.all(this.Qa.map(b=>{a[b]={};return Promise.all(Object.values(Hb).map(c=>Ob(this,b,c).then(d=>{a[b][c]=d})))})).then(()=>a)}getGrantStatus(){if(null!==this.I)return this.I.promise;this.I=new w;for(let a in this.N){let b=this.N[a];b.granted&&(Nb(this,b),this.I.resolve(!0))}if(W(this))this.I.resolve(!1);else this.onChange(a=>{a.entitlement.granted?this.I.resolve(!0):W(this)&&this.I.resolve(!1)});return this.I.promise}getGrantEntitlement(){if(this.Y)return this.Y.promise;this.Y=new w;this.F&&this.F.isSubscriber()||W(this)?this.Y.resolve(this.F):this.Na.add(()=>{(this.F&&this.F.isSubscriber()||W(this))&&this.Y.resolve(this.F)});return this.Y.promise}reset(){this.I=null}getAllPlatformsEntitlements(){if(this.W)return this.W.promise;this.W=new w;if(W(this))this.W.resolve(Pb(this));else this.onChange(()=>{W(this)&&this.W.resolve(Pb(this))});return this.W.promise}selectPlatform(){return this.getAllPlatformsEntitlements().then(()=>{var a;a:{W(this);for(a=this.getAvailablePlatforms();a.length;){let b=a.pop();if(this.getResolvedEntitlementFor(b.getServiceId()).isSubscriber()){a=b;break a}}a=Rb(this,Sb(this))}return a})}reportPlatformFailureAndFallback(a){if(a===this.getLocalPlatform().getServiceId()&&this.Ia)this.resolveEntitlement(this.getLocalPlatform().getServiceId(),this.Ia);else if(-1==this.fa.indexOf(a)){let b=U(a);this.resolveEntitlement(a,b);this.fa.push(a)}}selectPlatformForLogin(){return Ub(this)}}function Wb(a,b){a.eb.mutateElement(a.h.getBody(),()=>{a.h.getBody().classList.toggle("i-amphtml-subs-grant-unk",null===b);a.h.getBody().classList.toggle("i-amphtml-subs-grant-yes",!0===b);a.h.getBody().classList.toggle("i-amphtml-subs-grant-no",!1===b)})}function Xb(a,b){a.eb.mutateElement(a.h.getBody(),()=>{a.h.getBody().classList.toggle("i-amphtml-subs-loading",b)})}class Yb{constructor(a){this.h=a;this.eb=J(a,"mutator");this.setGrantState(null);this.h.getBody().classList.add("i-amphtml-subs-ready");this.addLoadingBar()}addLoadingBar(){return this.h.whenReady().then(()=>{let a=this.h.getBody();if(!a.querySelector("[subscriptions-section=loading]")){let b=Ja(this.h.win.document,"div",t({"class":"i-amphtml-subs-progress","subscriptions-section":"loading"}));a.insertBefore(b,Ma(a))}})}setGrantState(a){Wb(this,a)}toggleLoading(a){Xb(this,a)}}class Zb{constructor(a){this.H=a}getAnalytics(){return this.H.getAnalytics()}getDialog(){return this.H.getDialog()}getEncryptedDocumentKey(a){return this.H.getEncryptedDocumentKey(a)}getPageConfig(){return this.H.getPageConfig()}getReaderId(a){return this.H.getReaderId(a)}getScoreFactorStates(){return this.H.getScoreFactorStates()}delegateActionToLocal(a,b){return this.delegateActionToService(a,"local",b)}delegateActionToService(a,b,c){return this.H.delegateActionToService(a,b,c)}decorateServiceAction(a,b,c,d){this.H.decorateServiceAction(a,b,c,d)}resetPlatforms(){this.H.resetPlatforms()}selectPlatformForLogin(){return this.H.selectPlatformForLogin()}}let $b={"-":"+",_:"/",".":"="};function ac(a){let b=atob(a.replace(/[-_.]/g,a=>$b[a]));return Q(b)}function bc(a){a=a.trim();a=a.replace(/^\-+BEGIN[^-]*\-+/,"");a=a.replace(/\-+END[^-]*\-+$/,"");a=a.replace(/[\r\n]/g,"").trim();return Q(atob(a))}function cc(a){function b(){throw Error(`Invalid token: "${a}"`)}let c=a.split(".");3!=c.length&&b();let d=ac(c[0]),f=ac(c[1]);return{header:P(Wa(d),b),payload:P(Wa(f),b),verifiable:`${c[0]}.${c[1]}`,sig:c[2]}}function dc(a,b){return b.then(b=>a.va.importKey("spki",bc(b),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]))}class ec{constructor(a){this.win=a;this.va=a.crypto&&(a.crypto.subtle||a.crypto.webkitSubtle)||null}decode(a){return cc(a).payload}isVerificationSupported(){return!!this.va}decodeAndVerify(a,b){if(!this.va)throw Error("Crypto is not supported on this platform");return new Promise(b=>b(cc(a))).then(a=>{let c=a.header.alg;if(!c||"RS256"!=c)throw Error("Only alg=RS256 is supported");return dc(this,b).then(b=>{let c=ac(a.sig);return this.va.verify({name:"RSASSA-PKCS1-v1_5"},b,c,Q(a.verifiable))}).then(b=>{if(b)return a.payload;throw Error("Signature verification failed")})})}}let X;function fc(a,b,c){let e,d=a,f=c;e=a=>{try{return f(a)}catch(l){throw self.__AMP_REPORT_ERROR(l),l}};let g=gc();d.addEventListener(b,e,g?void 0:!1);return()=>{d&&d.removeEventListener(b,e,g?void 0:!1);e=d=f=null}}function gc(){if(void 0!==X)return X;X=!1;try{let a={get capture(){X=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(a){}return X}function hc(a,b){return fc(a,"message",b)}function ic(a,b){let c=b;let d=fc(a,"click",a=>{try{c(a)}finally{c=null,d()}});return d}let jc=/RETURN_URL/;function kc(a,b){{let c=J(a,"viewer");a=parseInt(a.getParam("dialog"),10)?new lc(c,b):new mc(a.win,c,b)}return a.open()}class lc{constructor(a,b){this.viewer=a;this.urlOrPromise=b}getLoginUrl(){return("string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise).then(a=>Y(a,"RETURN_URL"))}open(){return this.getLoginUrl().then(a=>this.viewer.sendMessageAwaitResponse("openDialog",t({url:a})))}}function nc(a){var b=a.win.screen,c=Math.floor(Math.min(700,.9*b.width));let d=Math.floor(Math.min(450,.9*b.height));b=`${`height=${d},width=${c},left=${Math.floor((b.width-c)/2)},top=${Math.floor((b.height-d)/2)}`},resizable=yes,scrollbars=yes`;let f=oc(a);a.ea=null;"string"==typeof a.urlOrPromise?(c=Y(a.urlOrPromise,f),a.w=Oa(a.win,c,b),a.w&&(a.ea=p())):(a.w=Oa(a.win,"",b),a.w&&(a.ea=a.urlOrPromise.then(b=>{b=Y(b,f);a.w.location.replace(b)},a=>{throw Error("failed to resolve url: "+a)})));a.ea?a.ea.then(()=>{pc(a,f)},b=>{Z(a,null,b)}):Z(a,null,Error("failed to open dialog"))}function qc(a){a.ga=null;a.Pa=null;if(a.w){try{a.w.close()}catch(b){}a.w=null}a.Z&&(a.win.clearInterval(a.Z),a.Z=null);a.sa&&(a.sa(),a.sa=null)}function oc(a){let b=a.viewer.getResolvedViewerUrl();return`${la.cdn}/v0/amp-login-done-0.1.html?url=`+encodeURIComponent(b)}function pc(a,b){let c=F(b).origin;a.Z=a.win.setInterval(()=>{a.w.closed&&(a.win.clearInterval(a.Z),a.Z=null,a.win.setTimeout(()=>{Z(a,"")},3e3))},500);a.sa=hc(a.win,b=>{b.origin==c&&b.data&&"amp"==b.data.sentinel&&"result"==b.data.type&&(a.w&&a.w.postMessage(t({sentinel:"amp",type:"result-ack"}),c),Z(a,b.data.result))})}function Z(a,b,c){a.ga&&(c?a.Pa(c):a.ga(b),qc(a))}class mc{constructor(a,b,c){this.win=a;this.viewer=b;this.urlOrPromise=c;this.sa=this.Z=this.ea=this.w=this.Pa=this.ga=null}open(){E(!this.ga,"Dialog already opened");return new Promise((a,b)=>{this.ga=a;this.Pa=b;nc(this)}).then(a=>{qc(this);return a},a=>{qc(this);throw a})}getLoginUrl(){return("string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise).then(a=>Y(a,oc(this)))}}function Y(a,b){return jc.test(a)?a.replace(jc,encodeURIComponent(b)):a+(-1==a.indexOf("?")?"?":"&")+"return="+encodeURIComponent(b)}function rc(a,b,c){let d=Date.now();if(a.P&&1e3>d-a.Za)return a.P;a.la.actionEvent("local",c,"started");let f=a.yb(b).then(b=>{a.P=null;b=ia(b).success;let d="true"==b||"yes"==b||"1"==b;d?a.la.actionEvent("local",c,"success"):a.la.actionEvent("local",c,"rejected");return d||!b}).catch(b=>{a.la.actionEvent("local",c,"failed");a.P==f&&(a.P=null);throw b});a.P=f;a.Za=d;return a.P}class sc{constructor(a,b,c,d){for(let a in d)ya(d[a],`action ${a}`);this.ka=d;this.za={};this.T=b;this.la=c;this.P=null;this.Za=0;this.yb=kc.bind(null,a);this.build()}build(){if(0==Object.keys(this.ka).length)return null;let a=[];for(let b in this.ka)a.push(this.T.buildUrl(this.ka[b],!0).then(a=>{this.za[b]=a}));return Promise.all(a).then(()=>this.za)}execute(a){E(this.ka[a],"Action URL is not configured: %s",a);let b=E(this.za[a],"Action URL is not ready: %s",a);return rc(this,b,a)}}var tc=function(){function a(a,b,c,d){c=c||{};for(d=a.length;d--;c[a[d]]=b);return c}function b(){this.yy={}}var c=[1,3],d=[1,4],f=[1,18],e=[1,19],g=[1,14],k=[1,15],l=[1,16],m=[1,17],G=[1,21],q=[1,22],r=[5,6,7,10],x=[5,6,7,10,15,16,17,18,19,20,21],B=[5,6,7,10,15,16,17,18,19,20,21,25,27],L={trace:function(){},yy:{},Eb:{error:2,result:3,search_condition:4,EOF:5,OR:6,AND:7,NOT:8,"(":9,")":10,predicate:11,comparison_predicate:12,truthy_predicate:13,scalar_exp:14,EQ:15,DEQ:16,NEQ:17,LT:18,LTE:19,GT:20,GTE:21,atom:22,field_ref:23,literal:24,DOT:25,field_name:26,"[":27,string:28,"]":29,NAME:30,STRING:31,NUMERIC:32,TRUE:33,FALSE:34,NULL:35,$accept:0,$end:1},ha:{2:"error",5:"EOF",6:"OR",7:"AND",8:"NOT",9:"(",10:")",15:"EQ",16:"DEQ",17:"NEQ",18:"LT",19:"LTE",20:"GT",21:"GTE",25:"DOT",27:"[",29:"]",30:"NAME",31:"STRING",32:"NUMERIC",33:"TRUE",34:"FALSE",35:"NULL"},hb:[0,[3,2],[4,3],[4,3],[4,2],[4,3],[4,1],[11,1],[11,1],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[13,1],[14,1],[14,1],[22,1],[23,3],[23,4],[23,1],[26,1],[28,1],[24,1],[24,1],[24,1],[24,1],[24,1]],performAction:function(a,b,c,d,f,e){var h=e.length-1;switch(f){case 1:return e[h-1];case 2:this.m=e[h-2]||e[h];break;case 3:this.m=e[h-2]&&e[h];break;case 4:this.m=!e[h];break;case 5:this.m=e[h-1];break;case 6:case 7:case 8:case 17:case 18:case 19:this.m=e[h];break;case 9:this.m=e[h-2]===e[h];break;case 10:throw Error('"==" is not allowed, use "="');case 11:this.m=e[h-2]!==e[h];break;case 12:this.m=typeof e[h-2]==typeof e[h]&&e[h-2]<e[h];break;case 13:this.m=typeof e[h-2]==typeof e[h]&&e[h-2]<=e[h];break;case 14:this.m=typeof e[h-2]==typeof e[h]&&e[h-2]>e[h];break;case 15:this.m=typeof e[h-2]==typeof e[h]&&e[h-2]>=e[h];break;case 16:this.m=void 0!==e[h]&&null!==e[h]&&""!==e[h]&&0!==e[h]&&!1!==e[h];break;case 20:this.m="[object Object]"==Object.prototype.toString.call(e[h-2])&&e[h-2].hasOwnProperty(e[h])?e[h-2][e[h]]:null;break;case 21:this.m="[object Object]"==Object.prototype.toString.call(e[h-3])&&e[h-3].hasOwnProperty(e[h-1])?e[h-3][e[h-1]]:null;break;case 22:this.m=void 0!==d[e[h]]?d[e[h]]:null;break;case 23:this.m=a;break;case 24:this.m=a.substring(1,a.length-1);break;case 26:this.m=Number(a);break;case 27:this.m=!0;break;case 28:this.m=!1;break;case 29:this.m=null}},table:[{3:1,4:2,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{1:[3]},{5:[1,20],6:G,7:q},{4:23,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{4:24,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},a(r,[2,6]),a(r,[2,7]),a(r,[2,8]),a(r,[2,16],{15:[1,25],16:[1,26],17:[1,27],18:[1,28],19:[1,29],20:[1,30],21:[1,31]}),a(x,[2,17]),a(x,[2,18],{25:[1,32],27:[1,33]}),a(x,[2,19]),a(B,[2,22]),a(x,[2,25]),a(x,[2,26]),a(x,[2,27]),a(x,[2,28]),a(x,[2,29]),a(B,[2,23]),a([5,6,7,10,15,16,17,18,19,20,21,29],[2,24]),{1:[2,1]},{4:34,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{4:35,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},a(r,[2,4]),{6:G,7:q,10:[1,36]},{14:37,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{14:38,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{14:39,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{14:40,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{14:41,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{14:42,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{14:43,22:9,23:10,24:11,26:12,28:13,30:f,31:e,32:g,33:k,34:l,35:m},{26:44,30:f},{28:45,31:e},a([5,6,10],[2,2],{7:q}),a(r,[2,3]),a(r,[2,5]),a(r,[2,9]),a(r,[2,10]),a(r,[2,11]),a(r,[2,12]),a(r,[2,13]),a(r,[2,14]),a(r,[2,15]),a(B,[2,20]),{29:[1,46]},a(B,[2,21])],defaultActions:{20:[2,1]},parseError:function(a,b){if(b.recoverable)this.trace(a);else throw a=Error(a),a.hash=b,a},parse:function(a){function b(){var a=n.lex()||1;"number"!==typeof a&&(a=c.Eb[a]||a);return a}var c=this,d=[0],e=[null],f=[],h=this.table,g="",k=0,l=0,m=0,r=f.slice.call(arguments,1),n=Object.create(this.lexer),q={yy:{}};for(u in this.yy)Object.prototype.hasOwnProperty.call(this.yy,u)&&(q.yy[u]=this.yy[u]);n.setInput(a,q.yy);q.yy.lexer=n;q.yy.parser=this;"undefined"==typeof n.yylloc&&(n.yylloc={});var x=n.yylloc;f.push(x);var G=n.options&&n.options.ranges;this.parseError="function"===typeof q.yy.parseError?q.yy.parseError:Object.getPrototypeOf(this).parseError;for(var v,B,y,aa,A,L,ba,K={};;){y=d[d.length-1];if(this.defaultActions[y])var u=this.defaultActions[y];else{if(null===v||"undefined"==typeof v)v=b();u=h[y]&&h[y][v]}if("undefined"===typeof u||!u.length||!u[0]){var ib="";ba=[];for(aa in h[y])this.ha[aa]&&2<aa&&ba.push("'"+this.ha[aa]+"'");ib=n.showPosition?"Parse error on line "+(k+1)+":\n"+n.showPosition()+"\nExpecting "+ba.join(", ")+", got '"+(this.ha[v]||v)+"'":"Parse error on line "+(k+1)+": Unexpected "+(1==v?"end of input":"'"+(this.ha[v]||v)+"'");this.parseError(ib,{text:n.match,token:this.ha[v]||v,line:n.yylineno,loc:x,expected:ba})}if(u[0]instanceof Array&&1<u.length)throw Error("Parse Error: multiple actions possible at state: "+y+", token: "+v);switch(u[0]){case 1:d.push(v);e.push(n.yytext);f.push(n.yylloc);d.push(u[1]);v=null;B?(v=B,B=null):(l=n.yyleng,g=n.yytext,k=n.yylineno,x=n.yylloc,0<m&&m--);break;case 2:A=this.hb[u[1]][1];K.m=e[e.length-A];K.Ya={first_line:f[f.length-(A||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(A||1)].first_column,last_column:f[f.length-1].last_column};G&&(K.Ya.range=[f[f.length-(A||1)].range[0],f[f.length-1].range[1]]);y=this.performAction.apply(K,[g,l,k,q.yy,u[1],e,f].concat(r));if("undefined"!==typeof y)return y;A&&(d=d.slice(0,-2*A),e=e.slice(0,-1*A),f=f.slice(0,-1*A));d.push(this.hb[u[1]][0]);e.push(K.m);f.push(K.Ya);L=h[d[d.length-2]][d[d.length-1]];d.push(L);break;case 3:return!0}}}},Mc=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a)},setInput:function(a,b){this.yy=b||this.yy||{};this._input=a;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;a.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b);this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);c.length-1&&(this.yylineno-=c.length-1);a=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[a[0],a[0]+this.yyleng-b]);this.yyleng=this.yytext.length;return this},more:function(){this._more=!0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var c;if(this.options.backtrack_lexer){var d={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};this.options.ranges&&(d.yylloc.range=this.yylloc.range.slice(0))}if(c=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._backtrack=this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];a=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(a)return a;if(this._backtrack)for(var f in d)this[f]=d[f];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a;this._more||(this.match=this.yytext="");for(var b=this._currentRules(),c=0;c<b.length;c++)if((a=this._input.match(this.rules[b[c]]))&&(!d||a[0].length>d[0].length)){var d=a;var f=c;if(this.options.backtrack_lexer){d=this.test_match(a,b[c]);if(!1!==d)return d;if(this._backtrack)d=!1;else return!1}else if(!this.options.flex)break}return d?(d=this.test_match(d,b[f]),!1!==d?d:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(a){a=this.conditionStack.length-1-Math.abs(a||0);return 0<=a?this.conditionStack[a]:"INITIAL"},pushState:function(a){this.begin(a)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(a,b,c){switch(c){case 1:return 7;case 2:return 6;case 3:return 8;case 4:return 35;case 5:return 33;case 6:return 33;case 7:return 34;case 8:return 34;case 9:return 9;case 10:return 10;case 11:return 27;case 12:return 29;case 13:return"|";case 14:return 19;case 15:return 18;case 16:return 21;case 17:return 20;case 18:return 17;case 19:return 16;case 20:return 15;case 21:return 32;case 22:return 30;case 23:return 31;case 24:return 31;case 25:return 25;case 26:return"INVALID";case 27:return 5}},rules:[/^(?:\s+)/,/^(?:AND\b)/,/^(?:OR\b)/,/^(?:NOT\b)/,/^(?:NULL\b)/,/^(?:TRUE\b)/,/^(?:true\b)/,/^(?:FALSE\b)/,/^(?:false\b)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:\|)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:!=)/,/^(?:==)/,/^(?:=)/,/^(?:-?[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:'[^']*')/,/^(?:"[^"]*")/,/^(?:\.)/,/^(?:.)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],inclusive:!0}}}}();L.lexer=Mc;b.prototype=L;L.Parser=b;return new b}();function uc(a,b){try{return tc.yy=b,!!tc.parse(a)}finally{tc.yy=null}}function vc(a,b){return uc(a,b)}function wc(a,b){xc(a,b,a.ca,vc)}function yc(a,b){return a.h.whenReady().then(()=>{let c=a.h.getRootNode().querySelectorAll("[subscriptions-dialog][subscriptions-display]");for(let a=0;a<c.length;a++){let d=c[a],e=d.getAttribute("subscriptions-display");if(e&&uc(e,b))return d}}).then(c=>{if(c){if("TEMPLATE"==c.tagName)return a.Fb.renderTemplate(c,b).then(c=>xc(a,b,c,vc));var d=c.cloneNode(!0);d.removeAttribute("subscriptions-dialog");d.removeAttribute("subscriptions-display");return d}}).then(b=>{if(b)return a.w.open(b,!0)})}function xc(a,b,c,d){return a.h.whenReady().then(()=>{let f=c.querySelectorAll('[subscriptions-action], [subscriptions-section="actions"], [subscriptions-actions]');for(let c=0;c<f.length;c++){let e=f[c],k=e.getAttribute("subscriptions-display");k&&d(k,b)?(e.classList.add("i-amphtml-subs-display"),e.getAttribute("subscriptions-service")&&e.getAttribute("subscriptions-action")&&"false"!==e.getAttribute("subscriptions-decorate")&&!e.hasAttribute("i-amphtml-subs-decorated")&&(a.o.decorateServiceAction(e,e.getAttribute("subscriptions-service"),e.getAttribute("subscriptions-action"),null),e.setAttribute("i-amphtml-subs-decorated",!0))):e.classList.remove("i-amphtml-subs-display")}return c})}class zc{constructor(a,b,c){this.h=a;this.ca=a.getRootNode();this.w=b;this.Fb=H(a.win,"templates");this.o=c}render(a){return Promise.all([wc(this,a),yc(this,a)])}reset(){this.w.close();return xc(this,{},this.ca,()=>!1)}}function Ac(a,b){return a.Bb.then(c=>{let d={READER_ID:c,ACCESS_READER_ID:c};b&&(d.AUTHDATA=b=>{if(a.ya)return Va(a.ya,b)});return d})}class Bc{constructor(a,b){{a=a.getHeadNode();let b=a.ownerDocument.defaultView;var c=b.__AMP_TOP||(b.__AMP_TOP=b);let l=b!=c;var d=c;if(d.__AMP__EXPERIMENT_TOGGLES)c=d.__AMP__EXPERIMENT_TOGGLES;else{d.__AMP__EXPERIMENT_TOGGLES=Object.create(null);c=d.__AMP__EXPERIMENT_TOGGLES;if(d.AMP_CONFIG)for(var f in d.AMP_CONFIG){var e=d.AMP_CONFIG[f];"number"===typeof e&&0<=e&&1>=e&&(c[f]=Math.random()<e)}if(d.AMP_CONFIG&&Array.isArray(d.AMP_CONFIG["allow-doc-opt-in"])&&0<d.AMP_CONFIG["allow-doc-opt-in"].length&&(f=d.AMP_CONFIG["allow-doc-opt-in"],e=d.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){e=e.getAttribute("content").split(",");for(var g=0;g<e.length;g++)-1!=f.indexOf(e[g])&&(c[e[g]]=!0)}Object.assign(c,za(d));if(d.AMP_CONFIG&&Array.isArray(d.AMP_CONFIG["allow-url-opt-in"])&&0<d.AMP_CONFIG["allow-url-opt-in"].length)for(f=d.AMP_CONFIG["allow-url-opt-in"],d=ia(d.location.originalHash||d.location.hash),e=0;e<f.length;e++)g=d[`e-${f[e]}`],"1"==g&&(c[f[e]]=!0),"0"==g&&(c[f[e]]=!1)}c=!!c["ampdoc-fie"];l&&!c?a=Aa(b,"url-replace")?I(b,"url-replace"):null:(a=M(a),a=N(a),a=Aa(a,"url-replace")?I(a,"url-replace"):null)}this.jb=a;this.Bb=b;this.ya=null}setAuthResponse(a){this.ya=a}buildUrl(a,b){return Ac(this,b).then(b=>this.jb.expandUrlAsync(a,b))}collectUrlVars(a,b){return Ac(this,b).then(b=>this.jb.collectVars(a,b))}}function Cc(a){let b=b=>{if(!b._AMP_SUBSCRIPTIONS_CLICK_HANDLED&&(b._AMP_SUBSCRIPTIONS_CLICK_HANDLED=!0,b=La(b.target))){let d=b.getAttribute("subscriptions-action");var c=b.getAttribute("subscriptions-service");"local"==c?a.executeAction(d,b.id):"auto"==(c||"auto")?"login"==d?(c=a.o.selectPlatformForLogin(),a.o.delegateActionToService(d,c.getServiceId(),b.id)):a.executeAction(d,b.id):c&&a.o.delegateActionToService(d,c,b.id)}};a.ca.addEventListener("click",b);a.ca.body&&a.ca.body.addEventListener("click",b)}function Dc(a,b){let c=b.json();return a.o.getScoreFactorStates().then(b=>{c.factors=b;return a.T.setAuthResponse(c)}).then(()=>a.$a.build()).then(()=>c)}class Ec{constructor(a,b,c){this.h=a;this.ca=a.getRootNode();this.J=b;this.Ab=!!this.J.pingbackAllEntitlements;this.o=c;this.T=new Bc(this.h,this.o.getReaderId("local"));this.A=c.getAnalytics();E(this.J.actions,"Actions have not been defined in the service config");this.$a=new sc(this.h,this.T,this.A,this.validateActionMap(this.J.actions));this.S=new zc(this.h,c.getDialog(),this.o)}getServiceId(){return"local"}validateActionMap(a){E(a.login,'Action "login" is not present in action map');E(a.subscribe,'Action "subscribe" is not present in action map');return a}activate(a){Dc(this,a).then(a=>{this.S.render(a)})}reset(){this.S.reset()}executeAction(a){return this.$a.execute(a).then(a=>{a&&this.o.resetPlatforms();return!!a})}isPrerenderSafe(){return!1}getSupportedScoreFactor(){return 0}getBaseScore(){return this.J.baseScore||0}getEntitlements(){}pingback(){}pingbackReturnsAllEntitlements(){return this.Ab}isPingbackEnabled(){return!1}decorateUI(){}}function Fc(a){a.$&&!a.Ua&&(a.Ua="function"==typeof a.Ta?a.Ta():a.Ta);return a.Ua}function Gc(a,b,c,d){let f=a.getTarget();a="connect"==c?null!=a.D?a.D:"*":a.getTargetOrigin();f.postMessage({sentinel:"__AMP__",_rsvp:b,cmd:c,payload:d||null},a)}class Hc{constructor(a,b,c){this.xa=a;this.Ta=b;this.D=c;this.$=this.Ua=null;this.ab=this.rb.bind(this);this.Cb=0;this.Xa={}}connect(a){if(this.$)throw Error("already connected");this.$=a;this.xa.addEventListener("message",this.ab)}disconnect(){this.$&&(this.$=null,this.xa.removeEventListener("message",this.ab))}isConnected(){return null!=this.D}getTarget(){let a=Fc(this);if(!a)throw Error("not connected");return a}getTargetOrigin(){if(null==this.D)throw Error("not connected");return this.D}sendCommand(a,b){Gc(this,void 0,a,b)}sendCommandRsvp(a,b){let c=String(++this.Cb);let d=null;let f=new Promise(a=>{d=a});this.Xa[c]={promise:f,resolver:d};Gc(this,c,a,b);return f}rb(a){let b=a.data;if(b&&"__AMP__"==b.sentinel){var c=a.origin,d=b.cmd,f=b.payload||null;null==this.D&&"start"==d&&(this.D=c);null==this.D&&a.source&&Fc(this)==a.source&&(this.D=c);if(c==this.D){var e=b._rsvp,g=!!e&&"rsvp"!=d;a=this.Ja(e,d,f);g&&Promise.resolve(a).then(a=>{Gc(this,e,"rsvp",{result:a})},a=>{Gc(this,e,"rsvp",{error:String(a)})})}}}Ja(a,b,c){if("rsvp"==b){let b=a&&this.Xa[a];b&&("error"in c?b.resolver(Promise.reject(Error(c.error))):b.resolver(c.result),delete this.Xa[a])}else return this.$(b,c)}}function Ic(a){return new Promise(b=>{let c=JSON.parse(JSON.stringify(a.J)),d=a.o.getPageConfig();c.pageConfig={publicationId:d.getPublicationId(),productId:d.getProductId(),encryptedDocumentKey:a.o.getEncryptedDocumentKey("local")||null};if(a.qa){let d=a.qa.join("&");a.T.collectUrlVars(d,!1).then(a=>{c.iframeVars=a;b(c)})}else b(c)})}class Jc extends Ec{constructor(a,b,c){super(a,b,c);this.Ka=E(this.J.iframeSrc,'"iframeSrc" URL must be specified');ya(this.Ka,"iframe Url");(this.qa=this.J.iframeVars||null)&&E(Array.isArray(this.qa),'"iframeVars" must be an array');this.D=F(this.Ka).origin;this.Ba=this.oa=null;this.ra=a.win.document.createElement("iframe");S(this.ra,!1);this.ta=new Hc(this.h.win,()=>this.ra.contentWindow,this.D);this.na=null;Cc(this)}getEntitlements(){return this.connect().then(()=>this.ta.sendCommandRsvp("authorize",{}).then(a=>{a.source="local-iframe";return a}).then(a=>Lb(a)))}isPingbackEnabled(){return!0}pingback(a){return this.connect().then(()=>this.ta.sendCommandRsvp("pingback",{entitlement:a}))}connect(){if(!this.Ba){let a=new w;this.Ba=a.promise;this.oa=a.resolve;this.na=Ic(this);this.ta.connect(this.Ja.bind(this));this.h.getBody().appendChild(this.ra);this.ra.src=this.Ka}return this.Ba}Ja(a){"connect"===a&&this.na.then(a=>{this.ta.sendCommandRsvp("start",{protocol:"amp-subscriptions",config:a}).then(()=>{this.oa&&(this.oa(),this.oa=null)})})}}function Kc(a){if(Array.isArray(a)){let b=[];a.forEach(a=>{b.push(a.jsonForPingback())});return JSON.stringify(b)}return JSON.stringify(a.jsonForPingback())}class Lc extends Ec{constructor(a,b,c){super(a,b,c);this.lb=ya(E(this.J.authorizationUrl,"Service config does not have authorization Url"),"Authorization Url");this.kb=H(this.h.win,"xhr");this.gb=this.J.pingbackUrl||null;Cc(this)}getEntitlements(){return this.T.buildUrl(this.lb,!1).then(a=>{let b=this.o.getEncryptedDocumentKey("local");b&&(a=xa(a,b));return this.kb.fetchJson(a,{credentials:"include"}).then(a=>a.json()).then(a=>Lb(a))})}isPingbackEnabled(){return!!this.gb}pingback(a){if(this.isPingbackEnabled)return this.T.buildUrl(this.gb,!0).then(b=>this.kb.sendSignal(b,{method:"POST",credentials:"include",headers:t({"Content-Type":"text/plain"}),body:Kc(a)}))}}function Nc(a,b,c){return"iframe"===b.type?new Jc(a,b,c):new Lc(a,b,c)}function Oc(a,b,c){return new Promise(d=>{var f=wa(a.h.win);var e=a.h.win.location;"string"==typeof e&&(e=F(e));var g=e;"string"==typeof g&&(g=F(g));if(la.cdnProxyRegex.test(g.origin)){g=e.pathname.split("/");E(oa[g[1]],"Unknown path prefix in url %s",e.href);var k=g[2],l="s"==k?"https://"+decodeURIComponent(g[3]):"http://"+decodeURIComponent(k);E(0<l.indexOf("."),"Expected a . in origin %s",l);g.splice(1,"s"==k?3:2);g=l+g.join("/");k=(k=e.search)&&"?"!=k?(k=k.replace(ra,"").replace(sa,"").replace(ta,"").replace(ua,"").replace(va,"").replace(/^[?&]/,""))?"?"+k:"":"";e=g+k+(e.hash||"")}else e=e.href;e=F(e).origin;let m=a.sb.decode(b),G=E(a.O.getProductId(),"Product id is null");if(m.aud!=f&&m.aud!=e)throw D().createError(`The mismatching "aud" field: ${m.aud}`);if(m.exp<Math.floor(Date.now()/1e3))throw D().createError("Payload is expired");f=m.entitlements;e=U("local");let q;if(f){if(Array.isArray(f)){for(g=0;g<f.length;g++)if(-1!==f[g].products.indexOf(G)){q=f[g];break}}else-1!==f.products.indexOf(G)&&(q=f);q&&(e=new V({source:"viewer",raw:b,granted:!0,grantReason:q.subscriptionToken?"SUBSCRIBER":"",dataObject:q,decryptedDocumentKey:c}))}m.metering&&!e.granted&&(e=new V({source:m.iss||"",raw:b,granted:!0,grantReason:"METERING",dataObject:m.metering,decryptedDocumentKey:c}));e.service="local";d(e)})}class Pc{constructor(a,b,c,d){this.h=a;this.o=c;this.O=c.getPageConfig();this.R=Nc(a,b,c);this.U=J(this.h,"viewer");this.U.onMessage("subscriptionchange",this.Db.bind(this));this.sb=new ec(a.win);this.Oa=this.O.getPublicationId();this.ob=this.O.getProductId();this.zb=d;this.L=O(a.win)}isPrerenderSafe(){return!0}getEntitlements(){let a=t({publicationId:this.Oa,productId:this.ob,origin:this.zb});let b;{let a=(this.U.getParam("cryptokeys")||"google.com").split(",");for(let c=0;c!=a.length&&!(b=this.o.getEncryptedDocumentKey(a[c]));c++);}b&&(a.encryptedDocumentKey=b);return this.L.timeoutPromise(3e3,this.U.sendMessageAwaitResponse("auth",a)).then(a=>{a=a||{};let b=a.error,c=a.authorization,e=a.decryptedDocumentKey;if(b)throw Error(b.message);return c?Oc(this,c,e).catch(a=>{this.U.sendMessage("auth-rejected",t({reason:a.message}));throw a}):U("local")})}getServiceId(){return this.R.getServiceId()}activate(){}reset(){}isPingbackEnabled(){return this.R.isPingbackEnabled()}pingbackReturnsAllEntitlements(){return this.R.pingbackReturnsAllEntitlements()}pingback(a){this.R.pingback(a)}getSupportedScoreFactor(a){return this.R.getSupportedScoreFactor(a)}getBaseScore(){return 0}executeAction(a,b){return this.R.executeAction(a,b)}decorateUI(a,b,c){return this.R.decorateUI(a,b,c)}Db(){this.o.resetPlatforms()}}function Qc(a,b){let c=a.getHeadNode(),d=Rc(c,Sc(c));if(b){let c=a.getRootNode();if(Tc(c,d))b(d);else var f=setInterval(()=>{Tc(c,d)&&(clearInterval(f),b(d))},4)}}function Rc(a,b){let c=a.__AMP_CSS_SM;c||(c=a.__AMP_CSS_SM=Object.create(null));{let d=Uc(a,c,"amp-extension=amp-subscriptions");if(d)return d.textContent!==b&&(d.textContent=b),d}let d=(a.ownerDocument||a).createElement("style");d.textContent=b;let f=null;d.setAttribute("amp-extension","amp-subscriptions");f=Uc(a,c,"amp-runtime");Ia(a,d,f);return c["amp-extension=amp-subscriptions"]=d}function Uc(a,b,c){return b[c]?b[c]:(a=a.querySelector(`style[${c}]`))?b[c]=a:null}function Sc(a){return(a=a.__AMP_CSS_TR)?a("[subscriptions-action]:not(.i-amphtml-subs-display),[subscriptions-actions]:not(.i-amphtml-subs-display),[subscriptions-section=actions]:not(.i-amphtml-subs-display),body.i-amphtml-subs-delegated [subscriptions-section=actions],body.i-amphtml-subs-grant-unk [subscriptions-action],body.i-amphtml-subs-grant-unk [subscriptions-section=actions],body:not(.i-amphtml-subs-grant-no) [subscriptions-section=content-not-granted],body:not(.i-amphtml-subs-grant-yes) [subscriptions-section=content],body:not(.i-amphtml-subs-loading) [subscriptions-section=loading]{display:none!important}amp-subscriptions-dialog{display:block!important;position:fixed!important;bottom:0!important;left:0!important;margin-left:0!important;width:100%!important;z-index:2147483641!important;max-height:90vh;box-sizing:border-box;opacity:1;background-image:none;background-color:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,0.2);margin-bottom:0;transition:transform 0.3s ease-in}.i-amphtml-subs-dialog-close-button{position:absolute;width:28px;height:28px;top:-28px;right:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='13' viewBox='341 8 13 13' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%234F4F4F' d='M354 9.31L352.69 8l-5.19 5.19L342.31 8 341 9.31l5.19 5.19-5.19 5.19 1.31 1.31 5.19-5.19 5.19 5.19 1.31-1.31-5.19-5.19z' fill-rule='evenodd'/%3E%3C/svg%3E\");background-size:13px 13px;background-position:9px;background-color:#fff;background-repeat:no-repeat;box-shadow:0 -1px 1px 0 rgba(0,0,0,0.2);border:none;border-radius:12px 0 0 0;cursor:pointer}body:not(.i-amphtml-subs-grant-yes) .i-amphtml-subs-dialog-close-button{display:none}.i-amphtml-subs-progress{height:2px;background-color:#ccc;position:relative;margin:8px;overflow:hidden}.i-amphtml-subs-progress:after{content:\"\";background-color:#2196f3;height:2px;position:absolute;left:0;top:0;width:20%;animation:i-amphtml-subs-loading-progress 1500ms ease-in-out infinite}@keyframes i-amphtml-subs-loading-progress{0%{transform:translateX(-100%)}to{transform:translateX(500%)}}@media (min-width:480px){amp-subscriptions-dialog{width:480px!important;left:-240px!important;margin-left:50vw!important}}\n/*# sourceURL=/extensions/amp-subscriptions/0.1/amp-subscriptions.css*/"):"[subscriptions-action]:not(.i-amphtml-subs-display),[subscriptions-actions]:not(.i-amphtml-subs-display),[subscriptions-section=actions]:not(.i-amphtml-subs-display),body.i-amphtml-subs-delegated [subscriptions-section=actions],body.i-amphtml-subs-grant-unk [subscriptions-action],body.i-amphtml-subs-grant-unk [subscriptions-section=actions],body:not(.i-amphtml-subs-grant-no) [subscriptions-section=content-not-granted],body:not(.i-amphtml-subs-grant-yes) [subscriptions-section=content],body:not(.i-amphtml-subs-loading) [subscriptions-section=loading]{display:none!important}amp-subscriptions-dialog{display:block!important;position:fixed!important;bottom:0!important;left:0!important;margin-left:0!important;width:100%!important;z-index:2147483641!important;max-height:90vh;box-sizing:border-box;opacity:1;background-image:none;background-color:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,0.2);margin-bottom:0;transition:transform 0.3s ease-in}.i-amphtml-subs-dialog-close-button{position:absolute;width:28px;height:28px;top:-28px;right:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='13' viewBox='341 8 13 13' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%234F4F4F' d='M354 9.31L352.69 8l-5.19 5.19L342.31 8 341 9.31l5.19 5.19-5.19 5.19 1.31 1.31 5.19-5.19 5.19 5.19 1.31-1.31-5.19-5.19z' fill-rule='evenodd'/%3E%3C/svg%3E\");background-size:13px 13px;background-position:9px;background-color:#fff;background-repeat:no-repeat;box-shadow:0 -1px 1px 0 rgba(0,0,0,0.2);border:none;border-radius:12px 0 0 0;cursor:pointer}body:not(.i-amphtml-subs-grant-yes) .i-amphtml-subs-dialog-close-button{display:none}.i-amphtml-subs-progress{height:2px;background-color:#ccc;position:relative;margin:8px;overflow:hidden}.i-amphtml-subs-progress:after{content:\"\";background-color:#2196f3;height:2px;position:absolute;left:0;top:0;width:20%;animation:i-amphtml-subs-loading-progress 1500ms ease-in-out infinite}@keyframes i-amphtml-subs-loading-progress{0%{transform:translateX(-100%)}to{transform:translateX(500%)}}@media (min-width:480px){amp-subscriptions-dialog{width:480px!important;left:-240px!important;margin-left:50vw!important}}\n/*# sourceURL=/extensions/amp-subscriptions/0.1/amp-subscriptions.css*/"}function Tc(a,b){let c=a.styleSheets;for(a=0;a<c.length;a++)if(c[a].ownerNode==b)return!0;return!1}self.__AMP_ERRORS=self.__AMP_ERRORS||[];function Vc(a,b){if(a.ba)return a.ba;a.ba=Wc(a,b).catch(b=>{a.ba=null;throw b});return a.ba}function Wc(a,b){if(0==b)return p();let c=[];return new Promise((d,f)=>{c.push(a.h.onVisibilityChanged(()=>{a.h.isVisible()||f(Error("CANCELLED"))}));let e=a.L.delay(d,b);c.push(()=>a.L.cancel(e));c.push(a.V.onScroll(d));c.push(ic(a.h.getRootNode(),d))}).then(()=>{c.forEach(a=>a())},a=>{c.forEach(a=>a());throw a})}class Xc{constructor(a){this.h=a;this.ba=null;this.L=O(a.win);this.V=J(a,"viewport")}scheduleView(a){this.ba=null;return this.h.whenReady().then(()=>new Promise(a=>{this.h.isVisible()&&a();this.h.onVisibilityChanged(()=>{this.h.isVisible()&&a()})}).then(()=>Vc(this,a)))}}function Yc(a){return a.waitForBodyOpen().then(()=>{let b=a.getBody(),c=Ha(b,()=>!!b.firstElementChild);return O(a.win).timeoutPromise(2e3,c).then(()=>"AMP-STORY"===b.firstElementChild.tagName,()=>!1)})}function Zc(a){if(!a.La){let b=new Gb(a.h),c=new ub(b);a.La=Promise.all([$c(a),c.resolveConfig()]).then(b=>{a.G=b[0];a.O=b[1]})}return a.La}function ad(a){let b=wa(a.h.win);bd(a,["local"]);a.G.services.forEach(c=>{if("local"==(c.serviceId||"local")){let d=new Pc(a.h,c,a.o,b);a.j.resolvePlatform("local",d);cd(a,d).then(b=>{dd(a,"local",b)}).catch(b=>{a.j.reportPlatformFailureAndFallback("local");ma().error("amp-subscriptions","Viewer auth failed:",b)})}})}function ed(a,b=!0){a.j.getGrantStatus().then(b=>{a.S.toggleLoading(!1);a.Wa=a.Gb.scheduleView(2e3);a.pb&&!b||a.S.setGrantState(b);fd(a)});b&&gd(a)}function bd(a,b){let c=a.G.fallbackEntitlement?Lb(a.G.fallbackEntitlement):U("local");a.j=new Vb(b,a.G.score,c);b=a.j;hd(a)&&b.resolveEntitlement("local",new V({source:"",raw:"",granted:!0,grantReason:"UNLOCKED",dataObject:{}}))}function id(a,b){hd(a)?p():(b.isPrerenderSafe()?p():a.h.whenFirstVisible()).then(()=>a.L.timeoutPromise(3e3,cd(a,b)).then(c=>{c=c||U(b.getServiceId());dd(a,b.getServiceId(),c);return c}).catch(c=>{let d=b.getServiceId();a.j.reportPlatformFailureAndFallback(d);throw D().createError(`fetch entitlements failed for ${d}`,c)}))}function $c(a){return new Promise(b=>{let c=P(a.bb.textContent,a=>{throw D().createError('Failed to parse "amp-subscriptions" JSON: ',a)});b(c)})}function dd(a,b,c){a.j.resolveEntitlement(b,c);c.decryptedDocumentKey&&a.Da.tryToDecryptDocument(c.decryptedDocumentKey);a.A.serviceEvent("subscriptions-entitlement-resolved",b)}function cd(a,b){return b.getEntitlements().then(c=>c&&c.granted&&a.Da.isDocumentEncrypted()&&!c.decryptedDocumentKey?(("local"==b.getServiceId()?D():ma()).error("amp-subscriptions",`${b.getServiceId()}: Subscription granted and encryption enabled, but no decrypted document key returned.`),null):c)}function hd(a){return!a.O.isLocked()||a.G.alwaysGrant}function fd(a){a.Wa&&a.Wa.then(()=>{a.j.getAvailablePlatforms().forEach(b=>{b.isPingbackEnabled()&&(b.pingbackReturnsAllEntitlements()?a.j.getAllPlatformsEntitlements().then(a=>b.pingback(a)):a.j.getGrantEntitlement().then(a=>b.pingback(a||U("local"))))})})}function gd(a){Promise.all([a.j.getGrantStatus(),a.j.selectPlatform(),a.j.getGrantEntitlement()]).then(b=>{let c=b[1],d=b[2],f=a.j.getResolvedEntitlementFor(c.getServiceId()),e=d||f;c.activate(f,d);a.A.serviceEvent("subscriptions-service-activated",c.getServiceId());a.A.serviceEvent("subscriptions-platform-activated",c.getServiceId());e.granted?a.A.serviceEvent("subscriptions-access-granted",e.service):(a.A.serviceEvent("subscriptions-paywall-activated",c.getServiceId()),a.A.serviceEvent("subscriptions-access-denied",c.getServiceId()))})}class jd{constructor(a){let b=a.getElementById("amp-subscriptions");this.h=a;Qc(a,()=>{});this.La=null;this.S=new Yb(a);this.j=this.G=this.O=null;this.bb=D().assertElement(b);this.A=new Ra(this.bb);this.o=new Zb(this);this.w=new fb(a);this.Gb=new Xc(a);this.U=J(a,"viewer");this.Wa=null;this.L=O(a.win);this.pb=(this.Fa=this.U.hasCapability("auth"))&&this.U.hasCapability("paywall");this.nb=Ca(N(a),"cid");this.ib={};this.Da=new Za(a)}start(){Zc(this).then(()=>{this.A.event("subscriptions-started");this.S.toggleLoading(!0);E(this.O,"Page config is null");if(this.Fa)ad(this),ed(this,!1);else{E(this.G.services,"Services not configured in service config");var a=this.G.services.map(a=>a.serviceId||"local");bd(this,a);this.G.services.forEach(a=>{"local"==(a.serviceId||"local")&&this.j.resolvePlatform("local",Nc(this.h,a,this.o))});this.j.getAvailablePlatforms().forEach(a=>{id(this,a)});Yc(this.h).then(a=>{ed(this,!a)})}});return this}getAccessReaderId(){return Zc(this).then(()=>this.getReaderId("local"))}getAnalytics(){return this.A}getAuthdataField(a){return Zc(this).then(()=>this.j.getEntitlementPromiseFor("local")).then(b=>Va(b.json(),a))}getDialog(){return this.w}getEncryptedDocumentKey(a){return this.Da.getEncryptedDocumentKey(a)}getPageConfig(){return this.O}getReaderId(a){let b=this.ib[a];if(!b){let c=p(),d="amp-access"+("local"==a?"":"-"+a);b=this.nb.then(a=>a.get({scope:d,createCookieIfNotPresent:!0},c));this.ib[a]=b}return b}getScoreFactorStates(){return this.j.getScoreFactorStates()}registerPlatform(a,b){return Zc(this).then(()=>{if(!this.Fa){var c=this.G.services.filter(b=>(b.serviceId||"local")===a),d=E(c[0],"No matching services for the ID found"),f=b(d,this.o);this.j.resolvePlatform(f.getServiceId(),f);this.A.serviceEvent("subscriptions-service-registered",f.getServiceId());this.A.serviceEvent("subscriptions-platform-registered",f.getServiceId());id(this,f)}})}selectPlatformForLogin(){return this.j.selectPlatformForLogin()}resetPlatforms(){this.j=this.j.resetPlatformStore();this.S.toggleLoading(!0);this.j.getAvailablePlatforms().forEach(a=>{id(this,a)});this.A.serviceEvent("subscriptions-service-re-authorized","");this.A.serviceEvent("subscriptions-platform-re-authorized","");ed(this)}delegateActionToLocal(a,b){return this.delegateActionToService(a,"local",b)}delegateActionToService(a,b,c=null){return new Promise(d=>{this.j.onPlatformResolves(b,f=>{this.A.event("subscriptions-action-delegated",t({action:a,serviceId:b}),t({action:a,status:"started"}));d(f.executeAction(a,c))})})}decorateServiceAction(a,b,c,d){this.j.onPlatformResolves(b,b=>{b.decorateUI(a,c,d)})}}(a=>{a.registerServiceForDoc("subscriptions",(function(a){return new jd(a).start()}))})(self.AMP)}});