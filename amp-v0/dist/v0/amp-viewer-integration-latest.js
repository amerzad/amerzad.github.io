(self.AMP=self.AMP||[]).push({n:"amp-viewer-integration",p:"high",v:"2008290323002",f:(function(AMP,_){
'use strict';var m,p;function q(){return p?p:p=Promise.resolve(void 0)};function aa(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var ba=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function ca(a){var b=Object.create(null);if(!a)return b;for(var c;c=ba.exec(a);){var d=aa(c[1],c[1]),e=c[2]?aa(c[2].replace(/\+/g," "),c[2]):"";b[d]=e}return b};function da(a){var b=!1,c=null,d=a;return function(a){for(var e=[],g=0;g<arguments.length;++g)e[g-0]=arguments[g];b||(c=d.apply(self,e),b=!0,d=null);return c}};var r=self.AMP_CONFIG||{},ea=("string"==typeof r.cdnProxyRegex?new RegExp(r.cdnProxyRegex):r.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function fa(a){if(!self.document||!self.document.head||self.location&&ea.test(self.location.origin))return null;var b=self.document.head.querySelector('meta[name="'+a+'"]');return b&&b.getAttribute("content")||null}
var ha={thirdParty:r.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:r.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:("string"==typeof r.thirdPartyFrameRegex?new RegExp(r.thirdPartyFrameRegex):r.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,cdn:r.cdnUrl||fa("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:ea,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:r.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:r.betaErrorReportingUrl||
"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:r.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:r.geoApiUrl||fa("amp-geo-api")};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var u=self.__AMP_LOG;function v(){if(!u.user)throw Error("failed to call initLogConstructor");return u.user}function w(){if(u.dev)return u.dev;throw Error("failed to call initLogConstructor");}function ia(a,b,c){v().assert(a,b,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)};function x(a){return a||{}};function y(){this.va=100;this.U=this.ga=0;this.K=Object.create(null)}y.prototype.has=function(a){return!!this.K[a]};y.prototype.get=function(a){var b=this.K[a];if(b)return b.access=++this.U,b.payload};y.prototype.put=function(a,b){this.has(a)||this.ga++;this.K[a]={payload:b,access:this.U};if(!(this.ga<=this.va)){w().warn("lru-cache","Trimming LRU cache");a=this.K;var c=this.U+1,d;for(d in a){var e=a[d].access;if(e<c){c=e;var f=d}}void 0!==f&&(delete a[f],this.ga--)}};function ja(a){var b=a.length-6;return 0<=b&&a.indexOf("sticky",b)==b}function z(a){return 2>a.length?!1:0==a.lastIndexOf("--",0)};var ka=x({c:!0,v:!0,a:!0,ad:!0}),A,la,ma=/[?&]amp_js[^&]*/,na=/[?&]amp_gsa[^&]*/,oa=/[?&]amp_r[^&]*/,pa=/[?&]amp_kit[^&]*/,qa=/[?&]usqp[^&]*/;
function ra(a){A||(A=self.document.createElement("a"),la=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new y));var b=la,c=A;if(b&&b.has(a))a=b.get(a);else{c.href=a;c.protocol||(c.href=c.href);var d={href:c.href,protocol:c.protocol,host:c.host,hostname:c.hostname,port:"0"==c.port?"":c.port,pathname:c.pathname,search:c.search,hash:c.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==d.protocol&&443==d.port)d.port="",d.host=d.hostname;d.origin=
c.origin&&"null"!=c.origin?c.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;b&&b.put(a,d);a=d}return a}
function sa(a){"string"==typeof a&&(a=ra(a));var b=a;"string"==typeof b&&(b=ra(b));if(!ha.cdnProxyRegex.test(b.origin))return a.href;b=a.pathname.split("/");ia(ka[b[1]],"Unknown path prefix in url %s",a.href);var c=b[2],d="s"==c?"https://"+decodeURIComponent(b[3]):"http://"+decodeURIComponent(c);ia(0<d.indexOf("."),"Expected a . in origin %s",d);b.splice(1,"s"==c?3:2);b=d+b.join("/");d=(d=a.search)&&"?"!=d?(d=d.replace(ma,"").replace(na,"").replace(oa,"").replace(pa,"").replace(qa,"").replace(/^[?&]/,
""))?"?"+d:"":"";return b+d+(a.hash||"")};function ta(a){var b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(e){w().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}var c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(var d=0;d<c.length;d++)0!=c[d].length&&("-"==c[d][0]?a[c[d].substr(1)]=!1:a[c[d]]=!0);return a};function ua(a){var b=a.ownerDocument.defaultView,c=b.__AMP_TOP||(b.__AMP_TOP=b),d=b!=c;if(c.__AMP__EXPERIMENT_TOGGLES)var e=c.__AMP__EXPERIMENT_TOGGLES;else{c.__AMP__EXPERIMENT_TOGGLES=Object.create(null);e=c.__AMP__EXPERIMENT_TOGGLES;if(c.AMP_CONFIG)for(var f in c.AMP_CONFIG){var g=c.AMP_CONFIG[f];"number"===typeof g&&0<=g&&1>=g&&(e[f]=Math.random()<g)}if(c.AMP_CONFIG&&Array.isArray(c.AMP_CONFIG["allow-doc-opt-in"])&&0<c.AMP_CONFIG["allow-doc-opt-in"].length&&(f=c.AMP_CONFIG["allow-doc-opt-in"],
g=c.document.head.querySelector('meta[name="amp-experiments-opt-in"]'))){g=g.getAttribute("content").split(",");for(var k=0;k<g.length;k++)-1!=f.indexOf(g[k])&&(e[g[k]]=!0)}Object.assign(e,ta(c));if(c.AMP_CONFIG&&Array.isArray(c.AMP_CONFIG["allow-url-opt-in"])&&0<c.AMP_CONFIG["allow-url-opt-in"].length)for(f=c.AMP_CONFIG["allow-url-opt-in"],c=ca(c.location.originalHash||c.location.hash),g=0;g<f.length;g++)k=c["e-"+f[g]],"1"==k&&(e[f[g]]=!0),"0"==k&&(e[f[g]]=!1)}var h=!!e["ampdoc-fie"];d&&!h?a=B(b,
"hidden-observer")?C(b,"hidden-observer"):null:(a=D(a),a=va(a),a=B(a,"hidden-observer")?C(a,"hidden-observer"):null);return a}function E(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return C(a,b)}function F(a,b){var c=D(a);c=va(c);return C(c,b)}function D(a){return a.nodeType?E((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function va(a){a=D(a);return a.isSingleDoc()?a.win:a}
function C(a,b){B(a,b);var c=a.__AMP_SERVICES;c||(c=a.__AMP_SERVICES={});a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function B(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function wa(a){return a.parent&&a.parent!=a};function G(a,b){var c=this;this.qa=E(a,"timer");this.Aa=b;this.xa=0;this.G=-1;this.$=0;this.ea=!1;this.ta=function(){c.G=-1;c.$=0;c.ea=!0;c.Aa();c.ea=!1}}G.prototype.isPending=function(){return-1!=this.G};G.prototype.schedule=function(a){var b=a||this.xa;this.ea&&10>b&&(b=10);var c=Date.now()+b;return!this.isPending()||-10>c-this.$?(this.cancel(),this.$=c,this.G=this.qa.delay(this.ta,b),!0):!1};G.prototype.cancel=function(){this.isPending()&&(this.qa.cancel(this.G),this.G=-1)};var H,xa="Webkit webkit Moz moz ms O o".split(" ");function I(a,b,c){if(z(b))return b;H||(H=Object.create(null));var d=H[b];if(!d||c){d=b;if(void 0===a[b]){var e=b.charAt(0).toUpperCase()+b.slice(1);a:{for(var f=0;f<xa.length;f++){var g=xa[f]+e;if(void 0!==a[g]){e=g;break a}}e=""}var k=e;void 0!==a[k]&&(d=k)}c||(H[b]=d)}return d}function J(a,b,c){(b=I(a.style,b,void 0))&&(z(b)?a.style.setProperty(b,c):a.style[b]=c)}
function Ba(a,b){if(b=I(a.style,b,void 0))return z(b)?a.style.getPropertyValue(b):a.style[b]}function M(a,b){for(var c in b)J(a,c,b[c])}function Ca(a){var b=!1;void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","")};function Da(a,b){for(var c=[],d=0,e=0;e<a.length;e++){var f=a[e];b(f,e,a)?c.push(f):(d<e&&(a[d]=f),d++)}d<a.length&&(a.length=d);return c};function Ea(a,b,c,d,e){var f=this;this.ampdoc=a;this.B=b;this.sa=c;this.L=this.ca=d;this.I=e&&a.isSingleDoc();this.o=null;this.wa=0;this.h=[];this.T=new G(a.win,function(){return f.update()});this.O=null;this.N=[];this.R=[]}m=Ea.prototype;m.enterLightbox=function(a,b){var c=this,d=N(this);d&&d.setLightboxMode(!0);a&&b&&b.then(function(){Fa(c,a,!0);O(c);c.update()})};
m.leaveLightbox=function(){var a=N(this);a&&a.setLightboxMode(!1);var b=Da(this.h,function(a){return!!a.lightboxed});Ga(this,b);this.h.length||Ha(this)};
m.setup=function(){if(!F(this.ampdoc,"viewer").isEmbedded())return!1;var a=this.ampdoc.getRootNode(),b=a.styleSheets;if(!b)return!0;this.N.length=0;for(var c=this.R.length=0;c<b.length;c++){var d=b[c];if(!d)return w().error("FixedLayer","Aborting setup due to null stylesheet."),!0;var e=d,f=e.ownerNode;e.disabled||!f||"STYLE"!=f.tagName||f.hasAttribute("amp-boilerplate")||f.hasAttribute("amp-runtime")||f.hasAttribute("amp-extension")||Ia(this,d.cssRules)}Fa(this,a,void 0);O(this);this.update();0<
this.h.length&&this.observeHiddenMutations();var g=E(this.ampdoc.win,"platform");0<this.h.length&&!this.I&&g.isIos()&&v().warn("FixedLayer","Please test this page inside of an AMP Viewer such as Google's because the fixed or sticky positioning might have slightly different layout.");return!0};m.observeHiddenMutations=function(){Ja(this)};function Ha(a){a.T.cancel();var b=a.O;b&&(b(),a.O=null)}
function Ja(a){if(!a.O){var b=a.ampdoc.getRootNode();a.O=ua(b.documentElement||b).add(function(){a.T.isPending()||a.T.schedule(16)})}}m.updatePaddingTop=function(a,b){this.ca=a;b||(this.L=a);this.update()};m.transformMutate=function(a){a?this.h.forEach(function(b){b.fixedNow&&b.top&&(J(b.element,"transition","none"),b.transform&&"none"!=b.transform?J(b.element,"transform",b.transform+" "+a):J(b.element,"transform",a))}):this.h.forEach(function(a){a.fixedNow&&a.top&&M(a.element,{transform:"",transition:""})})};
m.addElement=function(a,b){if(!P(this,a,"*","fixed",b))return q();O(this);this.observeHiddenMutations();return this.update()};m.removeElement=function(a){a=Ka(this,a);Ga(this,a)};function Ga(a,b){0<b.length&&a.o&&a.B.mutate(function(){for(var c=0;c<b.length;c++){var d=b[c];"fixed"==d.position&&a.o.returnFrom(d)}})}m.isDeclaredFixed=function(a){return!!a.__AMP_DECLFIXED};m.isDeclaredSticky=function(a){return!!a.__AMP_DECLSTICKY};
m.update=function(){var a=this;this.h.filter(function(b){return!a.ampdoc.contains(b.element)}).forEach(function(b){return Ka(a,b.element)});if(0==this.h.length)return q();this.T.cancel();var b=!1;return this.B.runPromise({measure:function(c){for(var d=a.h,e=[],f=a.ampdoc.win,g=0;g<d.length;g++){var k=void 0,h={top:"",bottom:"-9999vh",transition:"none"},l=d[g].element.style;for(k in h)l.setProperty(I(l,k),h[k].toString(),"important")}for(g=0;g<d.length;g++)e.push((f.getComputedStyle(d[g].element)||
Object.create(null)).top);for(g=0;g<d.length;g++)J(d[g].element,"bottom","");for(g=0;g<d.length;g++){h=k=d[g];l=h.element;var n=h.forceTransfer;h=f.getComputedStyle(l)||Object.create(null);var K=l.offsetWidth,ya=l.offsetHeight,gb=l.offsetTop,t=h,za=void 0===t.position?"":t.position,hb=void 0===t.display?"":t.display;l=t.bottom;var ib=t.zIndex,jb=parseFloat(h.opacity);t=h[I(h,"transform")];h=h.top;var L="fixed"===za&&(n||0<K&&0<ya),Aa=ja(za);if("none"===hb||!L&&!Aa)c[k.id]={fixed:!1,sticky:!1,transferrable:!1,
top:"",zIndex:""};else{if("auto"===h||e[g]!==h)h=L&&gb===a.L+a.sa?"0px":"";var Y=!1;L&&(Y=!0===n?!0:!1===n?!1:0<jb&&300>ya&&!(!h&&!l));Y&&(b=!0);c[k.id]={fixed:L,sticky:Aa,transferrable:Y,top:h,zIndex:ib,transform:t}}}},mutate:function(c){b&&a.I&&N(a).update();for(var d=a.h,e=0;e<d.length;e++){var f=d[e],g=c[f.id];J(f.element,"transition","none");J(f.element,"transition","");if(g){var k=e,h=g,l=f.element,n=f.fixedNow;f.fixedNow=h.fixed;f.stickyNow=h.sticky;f.top=h.fixed||h.sticky?h.top:"";f.transform=
h.transform;!n||h.fixed&&h.transferrable||!a.o||a.o.returnFrom(f);h.top&&(h.fixed||h.sticky)&&!f.lightboxed&&(h.fixed||!a.I?J(l,"top","calc("+h.top+" + "+a.ca+"px)"):a.L===a.ca?J(l,"top",h.top):J(l,"top","calc("+h.top+" - "+a.L+"px)"));a.I&&h.fixed&&h.transferrable&&N(a).transferTo(f,k,h)}}}},{}).catch(function(a){w().error("FixedLayer","Failed to mutate fixed elements:",a)})};
function Fa(a,b,c){try{for(var d=0;d<a.N.length;d++)for(var e=a.N[d],f=b.querySelectorAll(e),g=0;g<f.length&&!(10<a.h.length);g++)P(a,f[g],e,"fixed",void 0,c);for(d=0;d<a.R.length;d++){var k=a.R[d],h=b.querySelectorAll(k);for(e=0;e<h.length;e++)P(a,h[e],k,"sticky",void 0,c)}}catch(l){w().error("FixedLayer","Failed to setup fixed elements:",l)}}
function P(a,b,c,d,e,f){e||b.hasAttribute("style")&&(Ba(b,"top")||Ba(b,"bottom"))&&v().error("FixedLayer","Inline styles with `top`, `bottom` and other CSS rules are not supported yet for fixed or sticky elements (#14186). Unexpected behavior may occur.",b);if(-1!==b.tagName.indexOf("LIGHTBOX"))return!1;var g;a:{for(g=b;g&&void 0!==g;g=g.parentElement)if(-1!==g.tagName.indexOf("LIGHTBOX"))break a;g=null}var k=g;if(!f&&k)return!1;f=a.h;var h=[];for(g=0;g<f.length;g++){var l=f[g].element;if(l===b)break;
if(l.contains(b))return!1;b.contains(l)&&h.push(l)}for(g=0;g<h.length;g++)a.removeElement(h[g]);g=null;for(l=0;l<f.length;l++){var n=f[l];if(n.element==b&&n.position==d){g=n;break}}l="fixed"==d;g?g.selectors.includes(c)||g.selectors.push(c):(a="F"+a.wa++,b.setAttribute("i-amphtml-fixedid",a),l?b.__AMP_DECLFIXED=!0:b.__AMP_DECLSTICKY=!0,g={id:a,element:b,position:d,selectors:[c],fixedNow:!1,stickyNow:!1,lightboxed:!!k},f.push(g));g.forceTransfer=l?e:!1;return!0}
function Ka(a,b){for(var c=[],d=0;d<a.h.length;d++){var e=a.h[d];e.element===b&&(e.lightboxed||a.B.mutate(function(){J(b,"top","")}),a.h.splice(d,1),c.push(e))}a.h.length||Ha(a);return c}function O(a){a.h.sort(function(a,c){var b=a.element,e=c.element;return b===e?0:b.compareDocumentPosition(e)&(Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINS)?1:-1})}function N(a){if(!a.I||a.o)return a.o;a.o=new La(a.ampdoc.win.document,a.B);return a.o}
function Ia(a,b){for(var c=0;c<b.length;c++){var d=b[c];if(4==d.type||12==d.type)Ia(a,d.cssRules);else if(1==d.type){var e=d.selectorText;d=d.style.position;"*"!==e&&d&&("fixed"===d?a.N.push(e):ja(d)&&a.R.push(e))}}}
function La(a,b){this.M=a;this.B=b;this.m=a.body.cloneNode(!1);this.m.removeAttribute("style");b=this.m;var c={position:"absolute",top:0,left:0,height:0,width:0,pointerEvents:"none",overflow:"hidden",animation:"none",background:"none",border:"none",borderImage:"none",boxSizing:"border-box",boxShadow:"none",float:"none",margin:0,opacity:1,outline:"none",padding:"none",transform:"none",transition:"none"};"display"in c&&w().error("STYLE","`display` style detected in styles. You must use toggle instead.");
M(b,c);this.m.style.display="block";a.documentElement.appendChild(this.m)}m=La.prototype;m.getRoot=function(){return this.m};m.setLightboxMode=function(a){var b=this;this.B.mutate(function(){var c=b.getRoot();a?c.setAttribute("i-amphtml-lightbox",""):c.removeAttribute("i-amphtml-lightbox")})};
m.update=function(){for(var a=this.M.body,b=this.m,c=a.attributes,d=b.attributes,e=0;e<c.length;e++){var f=c[e];"style"!==f.name&&d.setNamedItem(f.cloneNode(!1))}for(e=0;e<d.length;e++)f=d[e].name,"style"===f||"i-amphtml-lightbox"===f||a.hasAttribute(f)||(b.removeAttribute(f),e--)};
m.transferTo=function(a,b,c){var d=a.element;if(d.parentElement!=this.m){w().fine("FixedLayer","transfer to fixed:",a.id,a.element);v().warn("FixedLayer","In order to improve scrolling performance in Safari, we now move the element to a fixed positioning layer:",a.element);if(!a.placeholder){J(d,"pointer-events","initial");var e=a.placeholder=this.M.createElement("i-amphtml-fpa");Ca(e);e.setAttribute("i-amphtml-fixedid",a.id)}J(d,"zIndex","calc("+(1E4+b)+" + "+(c.zIndex||0)+")");a.lightboxed&&d.classList.add("i-amphtml-lightbox-element");
d.parentElement.replaceChild(a.placeholder,d);this.m.appendChild(d);a.selectors.some(function(a){try{var b=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.msMatchesSelector||d.oMatchesSelector;var c=b?b.call(d,a):!1}catch(h){w().error("FixedLayer","Failed to test query match:",h),c=!1}return c})||(v().warn("FixedLayer","Failed to move the element to the fixed position layer. This is most likely due to the compound CSS selector:",a.element),this.returnFrom(a))}};
m.returnFrom=function(a){if(a.placeholder&&this.M.contains(a.placeholder)){var b=a.element,c=a.placeholder;w().fine("FixedLayer","return from fixed:",a.id,b);a.lightboxed&&b.classList.remove("i-amphtml-lightbox-element");this.M.contains(b)?(J(a.element,"zIndex",""),c.parentElement.replaceChild(b,c)):c.parentElement.removeChild(c)}};var Q;function R(a,b,c,d){var e=a,f=c;var g=function(a){try{return f(a)}catch(n){throw self.__AMP_REPORT_ERROR(n),n;}};var k=Ma(),h=!1;d&&(h=d.capture);e.addEventListener(b,g,k?d:h);return function(){e&&e.removeEventListener(b,g,k?d:h);g=e=f=null}}function Ma(){if(void 0!==Q)return Q;Q=!1;try{var a={get capture(){Q=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return Q};function Na(a,b,c,d){return R(a,b,c,d)}function Oa(a,b,c){var d=c,e=R(a,b,function(a){try{d(a)}finally{d=null,e()}},void 0)};function Pa(a,b){this.win=a;this.F=b;Na(this.win.document,"focusin",this.V.bind(this),{capture:!1})}Pa.prototype.V=function(a){a.defaultPrevented||this.F.sendRequest(a.type,x({focusTargetRect:a.target.getBoundingClientRect()}),!1)};function S(a){this.Y=a;this.J=[];this.P=0}S.prototype.push=function(a){this.J[this.P]=a;this.P=(this.P+1)%this.Y};S.prototype.get=function(a){this.J.length>=this.Y&&(a=(this.P+a)%this.Y);return this.J[a]};S.prototype.size=function(){return this.J.length};var Qa=/[,.\s\u2022()]/;function Ra(a){return"\u2019"==a||"\u2018"==a?"'":"\u201c"==a||"\u201d"==a?'"':a.toLowerCase()}
function Sa(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e=[],f=0;f<d.length;f++){var g=d[f];Qa.test(g)||e.push(Ra(g))}var k=e.join("");k&&b.push(k)}return b}function T(a,b){this.Ea=a;this.ua=b;this.matches=[];this.oa={};this.ha=a.length-1;for(b=0;b<a.length;b++)this.oa[a[b]]=a.length-1-b}
T.prototype.update=function(){if(0<this.ha)this.ha--;else{for(var a=this.Ea,b=this.ua,c=b.size(),d=0;d<a.length;d++){var e=b.get(c-1-d).pos;e=Ra(e.node.wholeText[e.offset]);if(a[a.length-1-d]!=e){var f=this.oa[e];null==f&&(f=a.length);f-=d;1>f&&(f=1);this.ha=f-1;return}}var g=b.get(c-1),k=g.pos;this.matches.push({start:b.get(c-a.length),end:{pos:{node:k.node,offset:k.offset+1},idx:g.idx+1}})}};
function Ta(a,b,c){c=Sa(c);if(0>=c.length)return null;var d=new U(a,b);a=new S(c.map(function(a){return a.length}).reduce(function(a,b){return Math.max(a,b)}));for(var e=[new T(c[0],a)],f=-1;;){f++;b=d.next();if(null==b)return null;if(!Qa.test(b.node.wholeText[b.offset])){a.push({pos:b,idx:f});for(b=0;b<e.length;b++)e[b].update();if(0!=e[e.length-1].matches.length){if(e.length==c.length)break;e.push(new T(c[e.length],a))}}}a=[];c=c.length-1;a:for(;0<=c;c--){var g=e[c].matches;if(0==a.length)a.push(g[g.length-
1]);else{var k=a[a.length-1];for(b=g.length-1;0<=b;b--){var h=g[b];if(k.start.idx>=h.end.idx){a.push(h);continue a}}}}c=[];for(b=a.length-1;0<=b;b--)h=a[b],c.push({start:h.start.pos,end:h.end.pos});return c}
function Ua(a,b,c,d,e){if(c>=d)return null;a=a.document;var f=b.parentNode,g=b.wholeText;0<c&&f.insertBefore(a.createTextNode(g.substring(0,c)),b);var k=a.createElement("span");k.appendChild(a.createTextNode(g.substring(c,d)));f.insertBefore(k,b);e.push(k);var h=null;d<g.length&&(h=a.createTextNode(g.substring(d)),f.insertBefore(h,b));f.removeChild(b);return h}
function U(a,b){this.C=a;this.aa=b;this.H=-1;this.D=null;b instanceof a.Text?this.H=0:b instanceof a.Element&&"none"!=(a.getComputedStyle(b)||Object.create(null)).display&&(b=b.firstChild,null!=b&&(this.D=new U(a,b)))}U.prototype.next=function(){if(0<=this.H){if(this.H<this.aa.wholeText.length){var a=this.H;this.H++;a={node:this.aa,offset:a}}else a=null;return a}for(;null!=this.D;){a=this.D.next();if(null!=a)return a;var b=this.D.aa.nextSibling;this.D=null!=b?new U(this.C,b):null}return null};function Va(a){return"loading"!=a.readyState&&"uninitialized"!=a.readyState}function Wa(a,b){var c=Va(a);if(c)b(a);else{var d=function(){Va(a)&&(c||(c=!0,b(a)),a.removeEventListener("readystatechange",d))};a.addEventListener("readystatechange",d)}}function Xa(a){return new Promise(function(b){Wa(a,b)})};function Ya(a){a=ca(a.win.location.hash).highlight;if(!a||102400<a.length)return null;var b=JSON.parse(a),c=b.s;if(!(c instanceof Array)||15<c.length)return null;var d=0;for(a=0;a<c.length;a++){var e=c[a];if("string"!=typeof e||!e)return null;d+=e.length;if(1500<d)return null}var f=!1;b.n&&(f=!0);var g=!1;b.na&&(g=!0);return{sentences:c,skipScrollAnimation:g,skipRendering:f}}
function V(a,b){var c=this;this.j=a;this.Fa=F(a,"viewer");this.w=F(this.j,"viewport");this.l=null;Xa(a.win.document).then(function(){Za(c,b)})}function W(a,b,c){b=x({state:b});for(var d in c)b[d]=c[d];a.Fa.sendMessage("highlightState",b)}
function $a(a,b){var c=a.j.win;if(b=Ta(c,a.j.getBody(),b.sentences)){for(var d=[],e=null,f=0;f<b.length;f++){var g=b[f];e&&e.end.node==g.start.node&&e.end.offset==g.start.offset?e.end=g.end:(e=g,d.push(g))}b=d;d=[];for(e=0;e<b.length;e++){f=b[e];var k=f.start,h=f.end;g=b;for(f=e;;){if(k.node==h.node){if(k=Ua(c,k.node,k.offset,h.offset,d))for(f+=1;f<g.length;f++){var l=g[f];if(h.node!=l.start.node)break;l.start.node=k;l.start.offset-=h.offset;if(h.node!=l.end.node)break;l.end.node=k;l.end.offset-=
h.offset}break}a:{l=!0;for(var n=k.node;;){if(null==n){l=null;break a}if(l){var K=n.nextSibling;K?(n=K,l=!1):n=n.parentNode}else{if(n instanceof c.Text){l=n;break a}n.firstChild?n=n.firstChild:l=!0}}}Ua(c,k.node,k.offset,k.node.wholeText.length,d);if(!l)break;k={node:l,offset:0}}}d&&0!=d.length&&(a.l=d)}}V.prototype.onVisibleOnce=function(a){var b=this;a=da(a);this.j.onVisibilityChanged(function(){"visible"==b.j.getVisibilityState()&&a()})};
function Za(a,b){if(a.j.win.document.querySelector('script[id="amp-access"]'))W(a,"has_amp_access");else if($a(a,b),a.l){var c=X(a);W(a,"found",x({scroll:c}));if(!b.skipRendering){for(var d=0;d<a.l.length;d++)M(a.l[d],{backgroundColor:"#fcff00",color:"#000"});var e=a.j.getVisibilityState();b.skipScrollAnimation?"visible"==e?ab(a,c):(a.w.setScrollTop(c),a.onVisibleOnce(function(){ab(a,X(a))})):"visible"==e?bb(a,c):(a.w.setScrollTop(Math.max(0,c-500)),a.onVisibleOnce(function(){bb(a,X(a))}));Oa(a.j.getBody(),
"click",a.la.bind(a))}}else W(a,"not_found")}function X(a){var b=a.l;if(!b)return 0;a=a.w;for(var c=Number.MAX_VALUE,d=0,e=a.getPaddingTop(),f=0;f<b.length;f++){var g=a.getLayoutRect(b[f]),k=-e;if(0==k||0==g.width&&0==g.height)var h=g;else{h=g.left+0;k=g.top+k;var l=g.width;g=g.height;h={left:h,top:k,width:l,height:g,bottom:k+g,right:h+l,x:h,y:k}}g=h.bottom;c=Math.min(c,h.top);d=Math.max(d,g)}if(c>=d)return 0;b=a.getHeight()-e;b=(d+c-b)/2;b>c-80&&(b=c-80);return 0<b?b:0}
function ab(a,b){W(a,"auto_scroll");a.w.setScrollTop(b);W(a,"shown")}
function bb(a,b){a.w.setScrollTop(Math.max(0,b-500));var c=a.j.win.document.createElement("div");c.style.display="block";M(c,{position:"absolute",top:Math.floor(b)+"px",height:"1px",left:"0",width:"1px","pointer-events":"none"});var d=a.j.getBody();d.appendChild(c);W(a,"auto_scroll");a.w.animateScrollIntoView(c).then(function(){d.removeChild(c);var e=X(a);var f=a.w.getScrollTop();if(f==e&&f==b)e=null;else{var g={};f!=e&&(a.w.setScrollTop(e),g.nd=f-e);f!=b&&(g.od=f-b);e=g}W(a,"shown",e)})}
V.prototype.setupMessaging=function(a){a.registerHandler("highlightDismiss",this.la.bind(this))};V.prototype.la=function(){if(this.l)for(var a=0;a<this.l.length;a++)for(var b=this.l[a],c=["backgroundColor","color"],d=0;d<c.length;d++)J(b,c[d],null)};var cb="key code location ctrlKey shiftKey altKey metaKey repeat isComposing charCode keyCode which".split(" ");function db(a,b){this.win=a;this.F=b;a=this.W.bind(this);R(this.win,"keydown",a,void 0);R(this.win,"keypress",a,void 0);R(this.win,"keyup",a,void 0)}db.prototype.W=function(a){eb(a)||this.V(a)};db.prototype.V=function(a){this.F.sendRequest(a.type,fb(a),!1)};
function eb(a){if(a.defaultPrevented)return!0;if("Escape"==a.key)return!1;switch(a.target.nodeName){case "INPUT":return"checkbox"!=a.target.type||" "==a.key;case "TEXTAREA":case "BUTTON":case "SELECT":case "OPTION":return!0}return a.target.hasAttribute&&a.target.hasAttribute("contenteditable")}function fb(a){var b={};cb.forEach(function(c){void 0!==a[c]&&(b[c]=a[c])});return b};function kb(a){if("string"!=typeof a)return a;if("{"!=a.charAt(0))return null;try{return JSON.parse(a)}catch(b){return null}}function Z(a,b,c){this.C=a;this.ba=b;this.pa=c}Z.prototype.addEventListener=function(a,b){var c=this;this.C.addEventListener("message",function(a){a.origin==c.ba&&a.source==c.pa&&b(a)})};Z.prototype.postMessage=function(a){this.pa.postMessage(a,"null"===this.ba?"*":this.ba)};Z.prototype.start=function(){};
function lb(a,b,c,d){this.C=a;this.da=b;this.Ba=!!c;this.S=d||null;this.ra=!1;this.Ca=0;this.ja={};this.Z={};this.ka=null;this.da.addEventListener("message",this.ya.bind(this));this.da.start()}m=lb.prototype;m.registerHandler=function(a,b){this.Z[a]=b};m.unregisterHandler=function(a){delete this.Z[a]};m.setDefaultHandler=function(a){this.ka=a};
m.ya=function(a){if((a=kb(a.data))&&"__AMPHTML__"===a.app)if(this.S&&this.ra&&a.messagingToken!==this.S)mb(this,"amp-viewer-messaging: handleMessage_ error: ","invalid token");else if("q"===a.type)nb(this,a);else if("s"===a.type){var b=a.requestid,c=this.ja[b];c&&(delete this.ja[b],a.error?(mb(this,"amp-viewer-messaging: handleResponse_ error: ",a.error),c.reject(Error("Request "+a.name+" failed: "+a.error))):c.resolve(a.data))}};
m.sendRequest=function(a,b,c){var d=this,e=++this.Ca,f=void 0;c&&(f=new Promise(function(a,b){d.ja[e]={resolve:a,reject:b}}));ob(this,{app:"__AMPHTML__",requestid:e,type:"q",name:a,data:b,rsvp:c});return f};function pb(a,b,c,d){var e=d?d.message?d.message:String(d):"unknown error";mb(a,"amp-viewer-messaging: sendResponseError_, message name: "+c,e);ob(a,{app:"__AMPHTML__",requestid:b,type:"s",name:c,data:null,error:e})}
function ob(a,b){var c=Object.assign(b,{});a.S&&!a.ra&&(c.messagingToken=a.S);a.da.postMessage(a.Ba?JSON.stringify(c):c)}
function nb(a,b){var c=a.Z[b.name];c||(c=a.ka);if(!c)throw c=Error("Cannot handle request because no default handler is set!"),c.args=b.name,c;c=c(b.name,b.data,!!b.rsvp);if(b.rsvp){var d=b.requestid;if(!c)throw pb(a,d,b.name,Error("no response")),Error("expected response but none given: "+b.name);c.then(function(c){ob(a,{app:"__AMPHTML__",requestid:d,type:"s",name:b.name,data:c})},function(c){pb(a,d,b.name,c)})}}
function mb(a,b,c){if(a.C){var d="amp-messaging-error-logger: "+b;d+=" data: "+(c?c.message?c.message:String(c):"unknown error");a.C.viewerState=d}};var qb="altKey charCode ctrlKey detail eventPhase key layerX layerY metaKey pageX pageY returnValue shiftKey timeStamp type which".split(" "),rb="clientX clientY force identifier pageX pageY radiusX radiusY screenX screenY".split(" ");function sb(a,b){this.win=a;this.F=b;this.fa=!1;this.ia=[];b.registerHandler("scrollLock",this.Da.bind(this));tb(this)}
function tb(a){var b=a.W.bind(a),c=a.win.document,d={capture:!1,passive:!a.fa};a.ia.push(R(c,"touchstart",b,d),R(c,"touchend",b,d),R(c,"touchmove",b,d))}function ub(a){a.ia.forEach(function(a){return a()});a.ia.length=0}sb.prototype.W=function(a){switch(a.type){case "touchstart":case "touchend":case "touchmove":if(a&&a.type){var b=vb(a,qb);a.touches&&(b.touches=wb(a.touches));a.changedTouches&&(b.changedTouches=wb(a.changedTouches));this.F.sendRequest(a.type,b,!1)}this.fa&&a.cancelable&&a.preventDefault()}};
function wb(a){for(var b=[],c=0;c<a.length;c++)b.push(vb(a[c],rb));return b}function vb(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];void 0!==a[e]&&(c[e]=a[e])}return c}sb.prototype.Da=function(a,b,c){this.fa=!!b;ub(this);tb(this);return c?Promise.resolve({}):void 0};function xb(a){this.win=a;this.ma=this.A=!1;this.X=null}
xb.prototype.init=function(){var a=this;w().fine("amp-viewer-integration","handshake init()");var b=D(this.win.document),c=F(b,"viewer");this.A="1"==c.getParam("webview");this.ma=c.hasCapability("handshakepoll");var d=c.getParam("messagingToken"),e=c.getParam("origin")||"";if(!this.A&&!e)return q();F(b,"viewport").createFixedLayer(Ea);if(this.A||this.ma){var f=wa(this.win)?this.win.parent:null;return yb(this,f,e).then(function(f){return zb(a,c,b,e,new lb(a.win,f,a.A,d))})}if(f=Ya(b))this.X=new V(b,
f);f=new Z(this.win,e,this.win.parent);return zb(this,c,b,e,new lb(this.win,f,this.A,d))};
function yb(a,b,c){return new Promise(function(d){var e=Na(a.win,"message",function(f){w().fine("amp-viewer-integration","AMPDOC got a pre-handshake message:",f.type,f.data);var g=kb(f.data);if(g&&f.origin===c&&f.source===b&&"__AMPHTML__"==g.app&&"handshake-poll"==g.name){if(a.A&&(!f.ports||!f.ports.length))throw Error("Did not receive communication port from the Viewer!");f=f.ports&&0<f.ports.length?f.ports[0]:new Z(a.win,c,a.win.parent);d(f);e()}})})}
function zb(a,b,c,d,e){w().fine("amp-viewer-integration","Send a handshake request");var f=c.getUrl(),g=sa(f);return e.sendRequest("channelOpen",x({url:f,sourceUrl:g}),!0).then(function(){w().fine("amp-viewer-integration","Channel has been opened!");Ab(a,e,b,d)})}
function Ab(a,b,c,d){b.setDefaultHandler(function(a,b,d){return c.receiveMessage(a,b,d)});c.setMessageDeliverer(b.sendRequest.bind(b),d);Oa(a.win,"unload",a.za.bind(a,b));(c.hasCapability("swipe")||c.hasCapability("touch"))&&new sb(a.win,b);c.hasCapability("keyboard")&&new db(a.win,b);c.hasCapability("focus-rect")&&new Pa(a.win,b);null!=a.X&&a.X.setupMessaging(b)}xb.prototype.za=function(a){return a.sendRequest("unloaded",{},!0)};(function(a){(new xb(a.win)).init()})(self.AMP);
})});

//# sourceMappingURL=amp-viewer-integration-0.1.js.map
