(self.AMP=self.AMP||[]).push({n:"amp-access-laterpay",v:"2008290323002",f:(function(AMP,_){
'use strict';var g;function k(){return g?g:g=Promise.resolve(void 0)};function l(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b};function m(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var n=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function p(a){var b=Object.create(null);if(!a)return b;for(var c;c=n.exec(a);){var d=m(c[1],c[1]),e=c[2]?m(c[2].replace(/\+/g," "),c[2]):"";b[d]=e}return b};var r="";var t=self.AMP_CONFIG||{},u=("string"==typeof t.cdnProxyRegex?new RegExp(t.cdnProxyRegex):t.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function v(a){if(self.document&&self.document.head&&(!self.location||!u.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}t.cdnUrl||v("runtime-host");t.geoApiUrl||v("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var w=self.__AMP_LOG;function x(){if(!w.user)throw Error("failed to call initLogConstructor");return w.user}function y(){if(w.dev)return w.dev;throw Error("failed to call initLogConstructor");}function z(a,b,c,d,e,f){return x().assert(a,b,c,d,e,f,void 0,void 0,void 0,void 0,void 0)};function A(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return B(a,b)}function C(a){var b=D(a);b=E(b);return B(b,"viewport")}function D(a){return a.nodeType?A((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function E(a){a=D(a);return a.isSingleDoc()?a.win:a}function B(a,b){a=F(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}
function G(a){var b=F(a).access;if(b){if(b.promise)return b.promise;B(a,"access");return b.promise=Promise.resolve(b.obj)}return null}function F(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function H(){var a=new l,b=a.promise,c=a.resolve;a=a.reject;b.catch(function(){});return{obj:null,promise:b,resolve:c,reject:a,context:null,ctor:null}};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function I(a){return J(a).then(function(a){return z(a,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","access","amp-access","amp-access","amp-access")})}
function J(a){var b=G(E(a));if(b)return b;var c=D(a);return c.waitForBodyOpen().then(function(){var a=c.win;var b=c.win.document.head;if(b){var f={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(var h=0;h<b.length;h++){var q=b[h];q=q.getAttribute("custom-element")||q.getAttribute("custom-template");f[q]=!0}f=Object.keys(f)}else f=[];return f.includes("amp-access")?A(a,"extensions").waitForExtension(a,"amp-access"):k()}).then(function(){var b=c.win;if(b.__AMP_EXTENDED_ELEMENTS&&
b.__AMP_EXTENDED_ELEMENTS["amp-access"]){b=E(a);var e=G(b);e?b=e:(b=F(b),b.access=H(),b=b.access.promise)}else b=null;return b})};function K(a,b){var c=a.getHeadNode(),d=M(c,aa(c));if(b){var e=a.getRootNode();if(N(e,d))b(d);else var f=setInterval(function(){N(e,d)&&(clearInterval(f),b(d))},4)}}
function M(a,b){var c=a.__AMP_CSS_SM;if(!c){var d=Object.create(null);c=a.__AMP_CSS_SM=d}var e=O(a,c,"amp-extension=amp-access-laterpay");if(e)return e.textContent!==b&&(e.textContent=b),e;d=(a.ownerDocument||a).createElement("style");d.textContent=b;var f=null;d.setAttribute("amp-extension","amp-access-laterpay");b=f=O(a,c,"amp-runtime");(b=void 0===b?null:b)?a.insertBefore(d,b.nextSibling):a.insertBefore(d,a.firstChild);return c["amp-extension=amp-access-laterpay"]=d}
function O(a,b,c){return b[c]?b[c]:(a=a.querySelector("style["+c+"]"))?b[c]=a:null}
function aa(a){return(a=a.__AMP_CSS_TR)?a(".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,0.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.2/amp-access-laterpay.css*/"):".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,0.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.2/amp-access-laterpay.css*/"}
function N(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++)if(c[a].ownerNode==b)return!0;return!1};var P;function ba(a,b,c){var d=a,e=c;var f=function(a){try{return e(a)}catch(L){throw self.__AMP_REPORT_ERROR(L),L;}};var h=ca();d.addEventListener(b,f,h?void 0:!1);return function(){d&&d.removeEventListener(b,f,h?void 0:!1);f=d=e=null}}function ca(){if(void 0!==P)return P;P=!1;try{var a={get capture(){P=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return P};function Q(a,b,c){return ba(a,b,c)};var da={eu:"https://connector.laterpay.net",us:"https://connector.uselaterpay.com"},ea={eu:"https://connector.sandbox.laterpaytest.net",us:"https://connector.sandbox.uselaterpaytest.com"},fa={payLaterButton:"Buy Now, Pay Later",payNowButton:"Buy Now",defaultButton:"Buy Now",alreadyPurchasedLink:"I already bought this",sandbox:"Site in test mode. No payment required.",laterpayBadgePrefix:"Powered by ",laterpayBadgeSuffix:""};
function R(a,b){this.ampdoc=a.ampdoc;this.l=b;this.M=C(this.ampdoc);this.c=this.l.getAdapterConfig();this.w=this.A=this.B=this.F=null;this.G=[];this.C=!0;this.D=this.o=this.h=null;this.I=this.c.locale||"en";this.j=Object.assign({},fa,this.c.localeMessages||{});this.m=ha(this)+"/api/v2/fetch/amp/?article_url=CANONICAL_URL&amp_reader_id=READER_ID&return_url=RETURN_URL";var c=this.c.articleId;c&&(this.m+="&article_id="+encodeURIComponent(c));var d=this.c.jwt;d&&(this.m+="&jwt="+encodeURIComponent(d));
this.L=A(this.ampdoc.win,"timer");this.H=A(this.ampdoc.win,"vsync");this.N=A(this.ampdoc.win,"xhr");K(this.ampdoc,function(){})}
function ha(a){var b=a.c.region||"eu",c=self;if(c.__AMP_MODE)c=c.__AMP_MODE;else{var d=p(c.location.originalHash||c.location.hash);var e=p(c.location.search);r||(r=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"012008290323002");d={localDev:!1,development:!!(0<=["1","actions","amp","amp4ads","amp4email"].indexOf(d.development)||c.AMP_DEV_MODE),examiner:"2"==d.development,esm:!1,geoOverride:d["amp-geo"],minified:!0,lite:void 0!=e.amp_lite,test:!1,log:d.log,version:"2008290323002",rtvVersion:r};c=c.__AMP_MODE=
d}return c.development&&a.c.configUrl?a.c.configUrl:a.c.sandbox?ea[b]:da[b]}
R.prototype.authorize=function(){var a=this;return ia(this).then(function(b){if(204===b.status)throw x().createError("No merchant domains have been matched for this article, or no paid content configurations are setup.");a.c.scrollToTopAfterAuth&&a.H.mutate(function(){return a.M.setScrollTop(0)});S(a);return{access:b.access}},function(b){if(!b||!b.response)throw b;var c=b.response;if(402!==c.status)throw b;return c.json().catch(function(){}).then(function(b){a.F=b;a.B=ja(a,b.purchase_options);S(a).then(a.K.bind(a));
return{access:!1}})})};function ia(a){var b=a.m+"&article_title="+encodeURIComponent(T(a));return a.l.buildUrl(b,!1).then(function(b){return a.l.getLoginUrl(b)}).then(function(b){y().info("amp-access-laterpay","Authorization URL: ",b);return a.L.timeoutPromise(3E3,a.N.fetchJson(b,{credentials:"include"})).then(function(a){return a.json()})})}
function ja(a,b){var c=T(a),d={};d.singlePurchases=b.filter(function(a){return"single_purchase"===a.sales_model});d.singlePurchases.forEach(function(a){return a.description=c});d.timepasses=b.filter(function(a){return"timepass"===a.sales_model});d.subscriptions=b.filter(function(a){return"subscription"===a.sales_model});return d}function U(a,b){return a.ampdoc.win.document.createElement(b)}
function T(a){var b=a.ampdoc.getRootNode().querySelector(a.c.articleTitleSelector);z(b,"No article title element found with selector %s",a.c.articleTitleSelector);return b.textContent.trim()}function V(a){var b=a.ampdoc.getElementById("amp-access-laterpay-dialog");return x().assertElement(b,"No element found with id amp-access-laterpay-dialog")}
function S(a){if(a.C)return k();for(var b;b=a.G.shift();)b();a.A&&(a.A(),a.A=null);a.w&&(a.w(),a.w=null);return a.H.mutatePromise(function(){a.C=!0;a.h=null;for(var b=V(a);b.firstChild;)b.removeChild(b.firstChild)})}
R.prototype.K=function(){var a=this,b=V(this);this.h=U(this,"div");this.h.className="amp-access-laterpay-container";this.c.sandbox&&W(this,"sandbox");W(this,"header");var c=U(this,"ul");this.B.singlePurchases.forEach(function(b){c.appendChild(X(a,b))});this.B.timepasses.forEach(function(b){c.appendChild(X(a,b))});this.B.subscriptions.forEach(function(b){c.appendChild(X(a,b))});var d=U(this,"button");d.className="amp-access-laterpay-purchase-button";d.textContent=this.j.defaultButton;this.D=d;this.A=
Q(d,"click",function(b){Y(a,b,a.o.value,a.o.dataset.purchaseType)});this.h.appendChild(c);this.h.appendChild(d);this.h.appendChild(ka(this,this.F.identify_url));W(this,"footer");b.appendChild(this.h);b.appendChild(la(this));this.C=!1;ma(this,c.firstElementChild)};function ma(a,b){var c=b.querySelector('input[type="radio"]');c.checked=!0;Z(a,c)}function W(a,b){if(a.j[b]){var c=U(a,"p");c.className="amp-access-laterpay-"+b;c.textContent=a.j[b];a.h.appendChild(c)}}
function la(a){var b=U(a,"a");b.href="https://blog.laterpay.net/laterpay-academy/what-is-laterpay";b.target="_blank";b.textContent="LaterPay";var c=U(a,"p"),d=U(a,"span");d.textContent=a.j.laterpayBadgePrefix;var e=U(a,"span");e.textContent=a.j.laterpayBadgeSuffix;c.className="amp-access-laterpay-badge";c.appendChild(d);c.appendChild(b);c.appendChild(e);return c}
function X(a,b){var c=U(a,"li"),d=U(a,"label");d.for=b.title;d.appendChild(na(a,b));var e=U(a,"div");e.className="amp-access-laterpay-metadata";var f=U(a,"span");f.className="amp-access-laterpay-title";f.textContent=b.title;e.appendChild(f);f=U(a,"p");f.className="amp-access-laterpay-description";f.textContent=b.description;e.appendChild(f);d.appendChild(e);c.appendChild(d);c.appendChild(oa(a,b.price));return c}
function na(a,b){var c=U(a,"input");c.name="purchaseOption";c.type="radio";c.id=b.title;c.value=b.purchase_url;b="pay_later"===b.price.payment_model?"payLater":"payNow";c.setAttribute("data-purchase-action-label",a.j[b+"Button"]);c.setAttribute("data-purchase-type",b);a.G.push(Q(c,"change",a.J.bind(a)));return c}
function oa(a,b){var c=(b.amount/100).toLocaleString(a.I,{style:"decimal",minimumFractionDigits:0}),d=U(a,"span");d.className="amp-access-laterpay-price";d.textContent=c;var e=U(a,"sup");e.className="amp-access-laterpay-currency";e.textContent=b.currency;var f=U(a,"p");f.className="amp-access-laterpay-price-container";f.appendChild(d);f.appendChild(e);return f}
function ka(a,b){var c=U(a,"p");c.className="amp-access-laterpay-already-purchased-link-container";var d=U(a,"a");d.href=b;d.textContent=a.j.alreadyPurchasedLink;a.w=Q(d,"click",function(c){Y(a,c,b,"alreadyPurchased")});c.appendChild(d);return c}R.prototype.J=function(a){a.preventDefault();Z(this,a.target)};
function Z(a,b){var c=a.o,d=b.dataset.purchaseActionLabel;c&&c.classList.contains("amp-access-laterpay-selected")&&c.classList.remove("amp-access-laterpay-selected");a.o=b;a.o.classList.add("amp-access-laterpay-selected");a.D.textContent=d}function Y(a,b,c,d){b.preventDefault();a.l.buildUrl(c,!1).then(function(b){y().fine("amp-access-laterpay","Authorization URL: ",b);a.l.loginWithUrl(b,d)})}R.prototype.pingback=function(){return k()};(function(a){a.registerServiceForDoc("laterpay",function(a){a=a.getHeadNode();return I(a).then(function(a){var b=a.getVendorSource("laterpay"),c=new R(a,b);b.getAdapter().registerVendor(c);return c})})})(self.AMP);
})});

//# sourceMappingURL=amp-access-laterpay-0.2.js.map
