(self.AMP=self.AMP||[]).push({n:"amp-link-rewriter",v:"2008290323002",f:function(AMP,_){function m(a,b=""){try{return decodeURIComponent(a)}catch(c){return b}}let p=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;let q=self.AMP_CONFIG||{},r=("string"==typeof q.cdnProxyRegex?new RegExp(q.cdnProxyRegex):q.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function t(a){if(self.document&&self.document.head&&(!self.location||!r.test(self.location.origin))){var b=self.document.head.querySelector(`meta[name="${a}"]`);b&&b.getAttribute("content")}}q.cdnUrl||t("runtime-host");q.geoApiUrl||t("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};let u=self.__AMP_LOG;function v(a){u.user||(u.user=w());var b=u.user.win;return a&&a.ownerDocument.defaultView!=b?u.userForEmbed?u.userForEmbed:u.userForEmbed=w():u.user}function w(){throw Error("failed to call initLogConstructor")}let x=Object.prototype.hasOwnProperty;function z(a){let b="";try{"localStorage"in a&&(b=a.localStorage.getItem("amp-experiment-toggles"))}catch(d){}let c=b?b.split(/\s*,\s*/g):[];a=Object.create(null);for(let b=0;b<c.length;b++)0!=c[b].length&&("-"==c[b][0]?a[c[b].substr(1)]=!1:a[c[b]]=!0);return a}function A(a,b){var c=B(a);c=C(c);return D(c,b)}function B(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView;b=b.__AMP_TOP||(b.__AMP_TOP=b);a=D(b,"ampdoc").getAmpDoc(a)}return a}function C(a){a=B(a);return a.isSingleDoc()?a.win:a}function D(a,b){E(a,b);{let b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});a=b}b=a[b];b.obj||(b.obj=new b.ctor(b.context),b.ctor=null,b.context=null,b.resolve&&b.resolve(b.obj));return b.obj}function E(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor&&!a.obj)}
/*
    https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
let F;function G(a){var b=H;let c=a=>a,d=a.dataset;a={};let n=b?b:/^param(.+)/;for(let b in d){var g=b.match(n);g&&(g=g[1][0].toLowerCase()+g[1].substr(1),a[c(g)]=d[b])}return a}function I(a,b){let c=a.length;for(let d=0;d<c;d++)b(a[d],d)}function J(a){let b={};Object.keys(a).forEach(c=>{b[c]="^"+a[c]+"$"});return b}function K(a,b){let c=a.getRootNode();let d=b.section.join(" a, "),n=c.querySelectorAll("a");let g=[];0!==b.section.length&&(d+=" a",n=c.querySelectorAll(d));I(n,a=>{L(a,b)&&g.push(a)});return g}function L(a,b){let c=b.attribute;return Object.keys(c).every(b=>new RegExp(c[b]).test(a.getAttribute(b)))}let M=["href","id","rel","rev"],H=/^vars(.+)/,N=/^(?:https?:)?(?:\/\/)?([^\/?]+)/i,O={SOURCE_URL:!0,DOCUMENT_REFERRER:!0};function P(a,b){return null===a.m||0===a.m.length||0<a.m.filter(a=>a===b).length?!0:!1}function Q(a,b){let c=a.href;return b.some(a=>{let b=c.match(N);return b?N.test(c)&&b[1]===a:!0})}function R(a,b,c){M.forEach(a=>{b.getAttribute(a)&&(c[a]=b.getAttribute(a))});let d=G(b);Object.assign(c,d);c.random=Math.random().toString(32).substr(2);Object.keys(c).forEach(b=>{c[b]&&(a.c=a.c.replace("${"+b+"}",encodeURIComponent(c[b])))});a.c=a.c.replace(/\${[A-Za-z0-9]+}+/,()=>"");return a.c}class S{constructor(a,b,c){this.j=c;try{/^[\w-]+$/.test("script");if(void 0!==F)var d=F;else{try{let a=b.ownerDocument,c=a.createElement("div"),d=a.createElement("div");c.appendChild(d);var n=c.querySelector(":scope div")===d}catch(y){n=!1}d=F=n}if(d)var g=b.querySelectorAll("> script".replace(/^|,/g,"$&:scope "));else{b.classList.add("i-amphtml-scoped");let a="> script".replace(/^|,/g,"$&.i-amphtml-scoped "),c=b.querySelectorAll(a);b.classList.remove("i-amphtml-scoped");g=c}var e=g;if(1!==e.length)throw Error(`Found ${e.length} <script> children. Expected 1.`);var h=e[0];c=h;if("SCRIPT"!=c.tagName||!c.hasAttribute("type")||"APPLICATION/JSON"!=c.getAttribute("type").toUpperCase())throw Error('<script> child must have type="application/json"');try{var k=JSON.parse(h.textContent)}catch(y){throw Error("Failed to parse <script> contents. Is it valid JSON?")}var l=k}catch(y){throw v(b).createError("%s: %s","amp-link-rewriter",y)}k=l;l=k.output;v().assert(l,"amp-link-rewriter: output config property is required",void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0);this.l=l={output:k.output.toString(),section:x.call(k,"section")?k.section:[],attribute:x.call(k,"attribute")?J(k.attribute):{},vars:x.call(k,"vars")?k.vars:{}};this.m=K(this.j,this.l);this.h=a;this.c="";l=b.ownerDocument.defaultView;h=l.__AMP_TOP||(l.__AMP_TOP=l);k=l!=h;c=h;if(c.__AMP__EXPERIMENT_TOGGLES)var f=c.__AMP__EXPERIMENT_TOGGLES;else{c.__AMP__EXPERIMENT_TOGGLES=Object.create(null);h=c.__AMP__EXPERIMENT_TOGGLES;if(c.AMP_CONFIG)for(f in c.AMP_CONFIG)e=c.AMP_CONFIG[f],"number"===typeof e&&0<=e&&1>=e&&(h[f]=Math.random()<e);if(c.AMP_CONFIG&&Array.isArray(c.AMP_CONFIG["allow-doc-opt-in"])&&0<c.AMP_CONFIG["allow-doc-opt-in"].length&&(f=c.AMP_CONFIG["allow-doc-opt-in"],e=c.document.head.querySelector('meta[name="amp-experiments-opt-in"]')))for(e=e.getAttribute("content").split(","),g=0;g<e.length;g++)-1!=f.indexOf(e[g])&&(h[e[g]]=!0);Object.assign(h,z(c));if(c.AMP_CONFIG&&Array.isArray(c.AMP_CONFIG["allow-url-opt-in"])&&0<c.AMP_CONFIG["allow-url-opt-in"].length){f=c.AMP_CONFIG["allow-url-opt-in"];c=c.location.originalHash||c.location.hash;e=Object.create(null);if(c)for(;d=p.exec(c);)g=m(d[1],d[1]),d=d[2]?m(d[2].replace(/\+/g," "),d[2]):"",e[g]=d;c=e;for(e=0;e<f.length;e++)g=c[`e-${f[e]}`],"1"==g&&(h[f[e]]=!0),"0"==g&&(h[f[e]]=!1)}f=h}f=!!f["ampdoc-fie"];k&&!f?f=E(l,"url-replace")?D(l,"url-replace"):null:(f=B(b),f=C(f),f=E(f,"url-replace")?D(f,"url-replace"):null);this.A=f}handleClick(a){if(a&&(this.c=this.l.output,a.href.match(N)[1]!==this.c.match(N)[1]&&P(this,a))){var b=A(this.j,"documentInfo").get().sourceUrl.match(N)[1],c=A(this.j,"documentInfo").get().canonicalUrl.match(N)[1];if(!Q(a,[b,c])){this.c=this.A.expandUrlSync(this.c,{DOCUMENT_REFERRER:this.h},O);let b=this.l.vars;b instanceof Object&&(a.href=R(this,a,b))}}}}function T(a){A(a.getAmpDoc(),"navigation").registerAnchorMutator(b=>{a.o.handleClick(b)},0)}class U extends AMP.BaseElement{constructor(a){super(a);this.o=null;this.h=""}buildCallback(){let a=A(this.getAmpDoc(),"viewer");return this.getAmpDoc().whenReady().then(()=>a.getReferrerUrl()).then(a=>this.h=a).then(this.w.bind(this))}w(){this.o=new S(this.h,this.element,this.getAmpDoc());T(this)}isLayoutSupported(a){return"nodisplay"===a}}(a=>{a.registerElement("amp-link-rewriter",U)})(self.AMP)}});