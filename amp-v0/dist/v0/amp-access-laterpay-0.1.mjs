(self.AMP=self.AMP||[]).push({n:"amp-access-laterpay",v:"2008290323002",f:function(AMP,_){let g;function k(){return g?g:g=Promise.resolve(void 0)}class l{constructor(){let a,b;this.promise=new Promise((c,d)=>{a=c;b=d});this.resolve=a;this.reject=b}}let m=self.AMP_CONFIG||{},n=("string"==typeof m.cdnProxyRegex?new RegExp(m.cdnProxyRegex):m.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function p(a){if(self.document&&self.document.head&&(!self.location||!n.test(self.location.origin))){var b=self.document.head.querySelector(`meta[name="${a}"]`);b&&b.getAttribute("content")}}m.cdnUrl||p("runtime-host");m.geoApiUrl||p("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};let q=self.__AMP_LOG;function r(){if(!q.user)throw Error("failed to call initLogConstructor");return q.user}function t(a,b,c,d,f,e){return r().assert(a,b,c,d,f,e,void 0,void 0,void 0,void 0,void 0)}function u(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return v(a,b)}function w(a){var b=x(a);b=y(b);return v(b,"viewport")}function x(a){return a.nodeType?u((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function y(a){a=x(a);return a.isSingleDoc()?a.win:a}function v(a,b){a=z(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function A(a){let b=z(a).access;if(b){if(b.promise)return b.promise;v(a,"access");return b.promise=Promise.resolve(b.obj)}return null}function z(a){let b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function B(){let a=new l,b=a.promise,c=a.resolve,d=a.reject;b.catch(()=>{});return{obj:null,promise:b,resolve:c,reject:d,context:null,ctor:null}}
/*
    https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function C(a,b,c=null){c?a.insertBefore(b,c.nextSibling):a.insertBefore(b,a.firstChild)}function D(a){return E(a).then(a=>t(a,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","access","amp-access","amp-access","amp-access"))}function E(a){let b=A(y(a));if(b)return b;let c=x(a);return c.waitForBodyOpen().then(()=>{var a=c.win;var b=c.win.document.head;if(b){var e={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(let a=0;a<b.length;a++){var h=b[a];h=h.getAttribute("custom-element")||h.getAttribute("custom-template");e[h]=!0}e=Object.keys(e)}else e=[];return e.includes("amp-access")?u(a,"extensions").waitForExtension(a,"amp-access"):k()}).then(()=>{var b=c.win;if(b.__AMP_EXTENDED_ELEMENTS&&b.__AMP_EXTENDED_ELEMENTS["amp-access"]){b=y(a);let c=A(b);c?b=c:(b=z(b),b.access=B(),b=b.access.promise)}else b=null;return b})}function G(a,b){let c=a.getHeadNode(),d=H(c,I(c));if(b){let c=a.getRootNode();if(J(c,d))b(d);else var f=setInterval(()=>{J(c,d)&&(clearInterval(f),b(d))},4)}}function H(a,b){let c=a.__AMP_CSS_SM;if(!c){var d=Object.create(null);c=a.__AMP_CSS_SM=d}{let d=K(a,c,"amp-extension=amp-access-laterpay");if(d)return d.textContent!==b&&(d.textContent=b),d}d=(a.ownerDocument||a).createElement("style");d.textContent=b;let f=null;d.setAttribute("amp-extension","amp-access-laterpay");f=K(a,c,"amp-runtime");C(a,d,f);return c["amp-extension=amp-access-laterpay"]=d}function K(a,b,c){return b[c]?b[c]:(a=a.querySelector(`style[${c}]`))?b[c]=a:null}function I(a){return(a=a.__AMP_CSS_TR)?a(".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,0.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.1/amp-access-laterpay.css*/"):".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,0.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.1/amp-access-laterpay.css*/"}function J(a,b){let c=a.styleSheets;for(a=0;a<c.length;a++)if(c[a].ownerNode==b)return!0;return!1}let L;function M(a,b,c){let e,d=a,f=c;e=a=>{try{return f(a)}catch(F){throw self.__AMP_REPORT_ERROR(F),F}};let h=N();d.addEventListener(b,e,h?void 0:!1);return()=>{d&&d.removeEventListener(b,e,h?void 0:!1);e=d=f=null}}function N(){if(void 0!==L)return L;L=!1;try{let a={get capture(){L=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(a){}return L}function O(a,b,c){return M(a,b,c)}var P={eu:"https://connector.laterpay.net",us:"https://connector.uselaterpay.com"},Q={eu:"https://connector.sandbox.laterpaytest.net",us:"https://connector.sandbox.uselaterpaytest.com"};let R={premiumContentTitle:"Buy only this article",payLaterButton:"Buy Now, Pay Later",payNowButton:"Buy Now",defaultButton:"Buy Now",alreadyPurchasedLink:"I already bought this",sandbox:"Site in test mode. No payment required."};function aa(a){let b=a.c.region||"eu";return a.c.sandbox?Q[b]:P[b]}function ba(a){let b=a.C+"&article_title="+encodeURIComponent(S(a));return a.m.buildUrl(b,!1).then(b=>a.m.getLoginUrl(b)).then(b=>a.K.timeoutPromise(3e3,a.M.fetchJson(b,{credentials:"include"})).then(a=>a.json()))}function T(a){if(a.B)return k();let b;for(;b=a.F.shift();)b();a.A&&(a.A(),a.A=null);a.w&&(a.w(),a.w=null);return a.G.mutatePromise(()=>{a.B=!0;a.h=null;for(var b=U(a);b.firstChild;)b.removeChild(b.firstChild)})}function S(a){let b=a.ampdoc.getRootNode().querySelector(a.c.articleTitleSelector);t(b,"No article title element found with selector %s",a.c.articleTitleSelector);return b.textContent.trim()}function V(a,b){return a.ampdoc.win.document.createElement(b)}function U(a){let b=a.ampdoc.getElementById("amp-access-laterpay-dialog");return r().assertElement(b,"No element found with id amp-access-laterpay-dialog")}function W(a,b){if(a.l[b]){let c=V(a,"p");c.className="amp-access-laterpay-"+b;c.textContent=a.l[b];a.h.appendChild(c)}}function X(a,b){let c=V(a,"li"),d=V(a,"label");d.for=b.title;d.appendChild(ca(a,b));let f=V(a,"div");f.className="amp-access-laterpay-metadata";var e=V(a,"span");e.className="amp-access-laterpay-title";e.textContent=b.title;f.appendChild(e);e=V(a,"p");e.className="amp-access-laterpay-description";e.textContent=b.description;f.appendChild(e);d.appendChild(f);c.appendChild(d);c.appendChild(da(a,b.price));return c}function Y(a,b,c,d){b.preventDefault();a.m.buildUrl(c,!1).then(b=>{a.m.loginWithUrl(b,d)})}function ea(a,b){let c=V(a,"p");c.className="amp-access-laterpay-already-purchased-link-container";let d=V(a,"a");d.href=b;d.textContent=a.l.alreadyPurchasedLink;a.w=O(d,"click",c=>{Y(a,c,b,"alreadyPurchased")});c.appendChild(d);return c}function fa(a){let b=V(a,"a");b.href="https://laterpay.net";b.target="_blank";b.textContent="LaterPay";a=V(a,"p");a.className="amp-access-laterpay-badge";a.textContent="Powered by ";a.appendChild(b);return a}function ha(a,b){let c=b.querySelector('input[type="radio"]');c.checked=!0;Z(a,c)}function Z(a,b){let c=a.o,d=b.dataset.purchaseActionLabel;c&&c.classList.contains("amp-access-laterpay-selected")&&c.classList.remove("amp-access-laterpay-selected");a.o=b;a.o.classList.add("amp-access-laterpay-selected");a.D.textContent=d}function ca(a,b){let c=V(a,"input");c.name="purchaseOption";c.type="radio";c.id=b.title;c.value=b.purchase_url;b="ppu"===b.purchase_type?"payLater":"payNow";c.setAttribute("data-purchase-action-label",a.l[b+"Button"]);c.setAttribute("data-purchase-type",b);a.F.push(O(c,"change",a.I.bind(a)));return c}function da(a,b){let c=Object.keys(b)[0],d=(b[c]/100).toLocaleString(a.H,{style:"decimal",minimumFractionDigits:0}),f=V(a,"span");f.className="amp-access-laterpay-price";f.textContent=d;let e=V(a,"sup");e.className="amp-access-laterpay-currency";e.textContent=c;let h=V(a,"p");h.className="amp-access-laterpay-price-container";h.appendChild(f);h.appendChild(e);return h}class ia{constructor(a,b){this.ampdoc=a.ampdoc;this.m=b;this.L=w(this.ampdoc);this.c=this.m.getAdapterConfig();this.w=this.A=this.j=null;this.F=[];this.B=!0;this.D=this.o=this.h=null;this.H=this.c.locale||"en";this.l=Object.assign({},R,this.c.localeMessages||{});this.C=aa(this)+"/api/v1/public/amp?article_url=CANONICAL_URL&amp_reader_id=READER_ID&return_url=RETURN_URL";let c=this.c.articleId;c&&(this.C+="&article_id="+encodeURIComponent(c));this.K=u(this.ampdoc.win,"timer");this.G=u(this.ampdoc.win,"vsync");this.M=u(this.ampdoc.win,"xhr");G(this.ampdoc,()=>{})}authorize(){return ba(this).then(a=>{if(204===a.status)throw r().createError("No merchant domains have been matched for this article, or no paid content configurations are setup.");this.c.scrollToTopAfterAuth&&this.G.mutate(()=>this.L.setScrollTop(0));T(this);return{access:a.access}},a=>{if(!a||!a.response)throw a;let b=a.response;if(402!==b.status)throw a;return b.json().catch(()=>{}).then(a=>{this.j=a;T(this).then(this.J.bind(this));return{access:!1}})})}J(){let a=U(this);this.h=V(this,"div");this.h.className="amp-access-laterpay-container";this.c.sandbox&&W(this,"sandbox");W(this,"header");let b=V(this,"ul");this.j.premiumcontent.title=this.l.premiumContentTitle;this.j.premiumcontent.description=S(this);b.appendChild(X(this,this.j.premiumcontent));this.j.timepasses.forEach(a=>{b.appendChild(X(this,a))});this.j.subscriptions.forEach(a=>{b.appendChild(X(this,a))});let c=V(this,"button");c.className="amp-access-laterpay-purchase-button";c.textContent=this.l.defaultButton;this.D=c;this.A=O(c,"click",a=>{Y(this,a,this.o.value,this.o.dataset.purchaseType)});this.h.appendChild(b);this.h.appendChild(c);this.h.appendChild(ea(this,this.j.apl));W(this,"footer");a.appendChild(this.h);a.appendChild(fa(this));this.B=!1;ha(this,b.firstElementChild)}I(a){a.preventDefault();Z(this,a.target)}pingback(){return k()}}(function(a){a.registerServiceForDoc("laterpay",(function(a){a=a.getHeadNode();return D(a).then(a=>{let b=a.getVendorSource("laterpay"),c=new ia(a,b);b.getAdapter().registerVendor(c);return c})}))})(self.AMP)}});