(self.AMP=self.AMP||[]).push({n:"amp-vk",v:"2008290323002",f:function(AMP,_){let f=self.AMP_CONFIG||{},g=("string"==typeof f.cdnProxyRegex?new RegExp(f.cdnProxyRegex):f.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function h(a){if(self.document&&self.document.head&&(!self.location||!g.test(self.location.origin))){var b=self.document.head.querySelector(`meta[name="${a}"]`);b&&b.getAttribute("content")}}f.cdnUrl||h("runtime-host");f.geoApiUrl||h("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};let k=self.__AMP_LOG;function l(){if(!k.user)throw Error("failed to call initLogConstructor");return k.user}function m(a,b,c){return l().assert(a,b,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}function n(a){return a||{}}n({c:!0,v:!0,a:!0,ad:!0});function p(a,b){if(!b)return a;let c=a.split("#",2),e=c[0].split("?",2);let d=e[0]+(e[1]?`?${e[1]}&${b}`:`?${b}`);return d+=c[1]?`#${c[1]}`:""}function q(a){let b=[];for(let e in a){let d=a[e];if(null!=d)if(Array.isArray(d))for(var c=0;c<d.length;c++){let a=d[c];b.push(`${encodeURIComponent(e)}=${encodeURIComponent(a)}`)}else c=d,b.push(`${encodeURIComponent(e)}=${encodeURIComponent(c)}`)}return b.join("&")}function t(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return u(a,b)}function v(a){var b=w(a);b=w(b);b=b.isSingleDoc()?b.win:b;return u(b,"viewer")}function w(a){return a.nodeType?t((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function u(a,b){{let b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});a=b}b=a[b];b.obj||(b.obj=new b.ctor(b.context),b.ctor=null,b.context=null,b.resolve&&b.resolve(b.obj));return b.obj}
/*
    https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
let y;function z(a,b){let d,c=a,e=b;d=a=>{try{return e(a)}catch(x){throw self.__AMP_REPORT_ERROR(x),x}};let r=A();c.addEventListener("message",d,r?void 0:!1);return()=>{c&&c.removeEventListener("message",d,r?void 0:!1);d=c=e=null}}function A(){if(void 0!==y)return y;y=!1;try{let a={get capture(){y=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(a){}return y}function B(a,b){return z(a,b)}let C={POST:"post",POLL:"poll"};function D(a){return v(a.element).getReferrerUrl().then(b=>{let c=a.element.offsetWidth,e=a.getAmpDoc().getUrl(),d=n({app:"0",width:"100%",_ver:"1",owner_id:a.w,post_id:a.B,hash:a.o,amp:"1",startWidth:c,url:e,referrer:b,title:"AMP Post"});return p("https://vk.com/widget_post.php",q(d))})}function E(a){return v(a.element).getReferrerUrl().then(b=>{let c=a.getAmpDoc().getUrl();b=n({app:a.m,width:"100%",_ver:"1",poll_id:a.A,amp:"1",url:c,title:"AMP Poll",description:"",referrer:b});return p("https://vk.com/al_widget_poll.php",q(b))})}function F(a){let b=Date.now().toString(16);let c;"post"===a.h?c=D(a):"poll"===a.h&&(c=E(a));return c.then(a=>p(a,b))}class G extends AMP.BaseElement{constructor(a){super(a);this.j=null;this.C=0;this.A=this.m=this.o=this.B=this.w=this.h=this.l=null}preconnectCallback(a){t(this.win,"preconnect").url(this.getAmpDoc(),"https://vk.com",a)}buildCallback(){this.h=m(this.element.getAttribute("data-embedtype"),"The data-embedtype attribute is required for <amp-vk> %s",this.element);l().assertEnumValue(C,this.h,"data-embedtype");"post"===this.h?(this.w=m(this.element.getAttribute("data-owner-id"),"The data-owner-id attribute is required for <amp-vk> Post %s",this.element),this.B=m(this.element.getAttribute("data-post-id"),"The data-post-id attribute is required for <amp-vk> Post %s",this.element),this.o=m(this.element.getAttribute("data-hash"),"The data-hash attribute is required for <amp-vk> Post %s",this.element)):"poll"===this.h&&(this.m=m(this.element.getAttribute("data-api-id"),"The data-api-id attribute is required for <amp-vk> Poll %s",this.element),this.A=m(this.element.getAttribute("data-poll-id"),"The data-poll-id attribute is required for <amp-vk> Poll %s",this.element))}layoutCallback(){let a=this.element.ownerDocument.createElement("iframe");this.j=a;this.l=B(this.win,this.D.bind(this));return F(this).then(b=>{a.src=b;a.setAttribute("name","fXD");a.setAttribute("scrolling","no");a.setAttribute("frameborder","0");a.setAttribute("allowfullscreen","true");this.applyFillContent(a);this.element.appendChild(a);return this.loadPromise(a)})}D(a){if("https://vk.com"===a.origin&&a.source===this.j.contentWindow){var b=a.data;if(b&&(a=/\["resize",\[(\d+)\]]/.exec(b))&&a[1]){let b=parseInt(a[1],10);this.C!==b&&(this.C=b,this.forceChangeHeight(b))}}}isLayoutSupported(a){return"responsive"===a||"flex-item"===a||"fixed"===a}unlayoutOnPause(){return!0}unlayoutCallback(){if(this.j){var a=this.j;a.parentElement&&a.parentElement.removeChild(a);this.j=null}this.l&&this.l();return!0}}(a=>{a.registerElement("amp-vk",G)})(self.AMP)}});