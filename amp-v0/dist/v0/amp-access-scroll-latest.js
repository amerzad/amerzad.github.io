(self.AMP=self.AMP||[]).push({n:"amp-access-scroll",v:"2007102309000",f:(function(AMP,_){
var h,aa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function ba(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object");})()}ba(this);"function"===typeof Symbol&&Symbol("x");var m;
if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var n;a:{var ca={a:!0},p={};try{p.__proto__=ca;n=p.a;break a}catch(a){}n=!1}m=n?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var q=m;
function r(a,b){a.prototype=aa(b.prototype);a.prototype.constructor=a;if(q)q(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.aa=b.prototype}function ea(){var a,b;this.promise=new Promise(function(c,d){a=c;b=d});this.resolve=a;this.reject=b};function t(a,b){b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(c){return b}};var fa=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function u(a){var b=Object.create(null);if(!a)return b;for(var c;c=fa.exec(a);){var d=t(c[1],c[1]),e=c[2]?t(c[2].replace(/\+/g," "),c[2]):"";b[d]=e}return b};var v="";
function w(){var a=self;if(a.__AMP_MODE)var b=a.__AMP_MODE;else{b=u(a.location.originalHash||a.location.hash);var c=u(a.location.search);v||(v=a.AMP_CONFIG&&a.AMP_CONFIG.v?a.AMP_CONFIG.v:"012007102309000");b={localDev:!1,development:!!(0<=["1","actions","amp","amp4ads","amp4email"].indexOf(b.development)||a.AMP_DEV_MODE),examiner:"2"==b.development,esm:!1,geoOverride:b["amp-geo"],minified:!0,lite:void 0!=c.amp_lite,test:!1,log:b.log,version:"2007102309000",rtvVersion:v};b=a.__AMP_MODE=b}return b};var x=self.AMP_CONFIG||{},ha=("string"==typeof x.cdnProxyRegex?new RegExp(x.cdnProxyRegex):x.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function y(a){if(self.document&&self.document.head&&(!self.location||!ha.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}x.cdnUrl||y("runtime-host");x.geoApiUrl||y("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var z=self.__AMP_LOG;function A(){if(z.dev)return z.dev;throw Error("failed to call initLogConstructor");}function B(a,b,c,d,e,f){if(!z.user)throw Error("failed to call initLogConstructor");return z.user.assert(a,b,c,d,e,f,void 0,void 0,void 0,void 0,void 0)};var C=Object.prototype.hasOwnProperty;function D(a){return a||{}};function E(){this.X=100;this.H=this.O=0;this.B=Object.create(null)}E.prototype.has=function(a){return!!this.B[a]};E.prototype.get=function(a){var b=this.B[a];if(b)return b.access=++this.H,b.payload};E.prototype.put=function(a,b){this.has(a)||this.O++;this.B[a]={payload:b,access:this.H};if(!(this.O<=this.X)){A().warn("lru-cache","Trimming LRU cache");a=this.B;var c=this.H+1,d;for(d in a){var e=a[d].access;if(e<c){c=e;var f=d}}void 0!==f&&(delete a[f],this.O--)}};D({c:!0,v:!0,a:!0,ad:!0,action:!0});var F,G;
function H(a,b){var c=void 0===c?"source":c;B(null!=a,"%s %s must be available",b,c);var d=a;if("string"==typeof d){F||(F=self.document.createElement("a"),G=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new E));var e=G,f=F;if(e&&e.has(d))d=e.get(d);else{f.href=d;f.protocol||(f.href=f.href);var g={href:f.href,protocol:f.protocol,host:f.host,hostname:f.hostname,port:"0"==f.port?"":f.port,pathname:f.pathname,search:f.search,hash:f.hash,origin:null};"/"!==g.pathname[0]&&(g.pathname="/"+g.pathname);if("http:"==
g.protocol&&80==g.port||"https:"==g.protocol&&443==g.port)g.port="",g.host=g.hostname;g.origin=f.origin&&"null"!=f.origin?f.origin:"data:"!=g.protocol&&g.host?g.protocol+"//"+g.host:g.href;e&&e.put(d,g);d=g}}(e="https:"==d.protocol||"localhost"==d.hostname||"127.0.0.1"==d.hostname)||(d=d.hostname,e=d.length-10,e=0<=e&&d.indexOf(".localhost",e)==e);B(e||/^(\/\/)/.test(a),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,
a)};function I(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return J(a,b)}function K(a){var b=L(a);b=M(b);return J(b,"viewport")}function L(a){return a.nodeType?I((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function M(a){a=L(a);return a.isSingleDoc()?a.win:a}function J(a,b){a=N(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}
function ia(a){var b=N(a).access;if(b){if(b.promise)return b.promise;J(a,"access");return b.promise=Promise.resolve(b.obj)}return null}function N(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function ja(){var a=new ea,b=a.promise,c=a.resolve;a=a.reject;b.catch(function(){});return{obj:null,promise:b,resolve:c,reject:a,context:null,ctor:null}};var O;/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function P(a,b,c){a=a.createElement(b);for(var d in c)a.setAttribute(d,c[d]);return a};function ka(a){return la(a).then(function(a){return B(a,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","access","amp-access","amp-access","amp-access")})}
function la(a){var b=ia(M(a));if(b)return b;var c=L(a);return c.waitForBodyOpen().then(function(){var a=c.win;var b=c.win.document.head;if(b){var f={};b=b.querySelectorAll("script[custom-element],script[custom-template]");for(var g=0;g<b.length;g++){var l=b[g];l=l.getAttribute("custom-element")||l.getAttribute("custom-template");f[l]=!0}f=Object.keys(f)}else f=[];f.includes("amp-access")?a=I(a,"extensions").waitForExtension(a,"amp-access"):(O||(O=Promise.resolve(void 0)),a=O);return a}).then(function(){var b=
c.win;if(b.__AMP_EXTENDED_ELEMENTS&&b.__AMP_EXTENDED_ELEMENTS["amp-access"]){b=M(a);var e=ia(b);e?b=e:(b=N(b),b.access=ja(),b=b.access.promise)}else b=null;return b})};function R(a,b,c){this.ampdoc=a;this.R=c;this.l=B(b.authorization,'"authorization" URL must be specified');H(this.l,'"authorization"');this.J=!b.noPingback;this.F=b.pingback;this.J&&(B(this.F,'"pingback" URL must be specified'),H(this.F,'"pingback"'));b.authorizationTimeout?(c=b.authorizationTimeout,B("number"==typeof c,'"authorizationTimeout" must be a number'),w().development||(c=Math.min(c,3E3))):c=3E3;this.I=c;this.W=I(a.win,"xhr");this.$=I(a.win,"timer")}h=R.prototype;
h.getConfig=function(){return{authorizationUrl:this.l,pingbackEnabled:this.J,pingbackUrl:this.F,authorizationTimeout:this.I}};h.getAuthorizationUrl=function(){return this.l};h.isAuthorizationEnabled=function(){return!0};h.getAuthorizationTimeout=function(){return this.I};
h.authorize=function(){var a=this;A().fine("amp-access-client","Start authorization via ",this.l);return this.R.buildUrl(this.l,!1).then(function(b){A().fine("amp-access-client","Authorization URL: ",b);return a.$.timeoutPromise(a.I,a.W.fetchJson(b,{credentials:"include"})).then(function(a){return a.json()})})};h.isPingbackEnabled=function(){return this.J};
h.pingback=function(){var a=this;return this.R.buildUrl(this.F,!0).then(function(b){A().fine("amp-access-client","Pingback URL: ",b);return a.W.sendSignal(b,{method:"POST",credentials:"include",headers:D({"Content-Type":"application/x-www-form-urlencoded"}),body:""})})};h.postAction=function(){};function ma(a,b){function c(){d=0;var g=1E3-(a.Date.now()-e);if(0<g)d=a.setTimeout(c,g);else{var l=f;f=null;b.apply(null,l)}}var d=0,e=0,f=null;return function(b){for(var g=[],k=0;k<arguments.length;++k)g[k-0]=arguments[k];e=a.Date.now();f=g;d||(d=a.setTimeout(c,1E3))}};function na(a,b,c){var d=this;this.w=a;this.S=null;this.j=b;this.Y=c;var e=ma(a.win,this.Z.bind(this));this.V=K(a);this.M=[];a.whenReady().then(function(){d.V.onChanged(e);d.M=a.getBody().getElementsByTagName("p")})}
na.prototype.Z=function(){var a=this;return Promise.all([].slice.call(this.M).map(function(b){return a.V.getClientRectAsync(b)})).then(function(b){for(var c=null,d=null,e=b.length-1;0<=e;e--){var f=b[e].bottom;0>=f&&(null===d||d<f)&&(c=e,d=f)}null!==c&&(e=c,a.S!==e&&(a.S=e,oa(a,a.M[e].innerText.substring(0,50))))})};
function oa(a,b){a.j.buildUrl(a.Y+"/amp/updatedepth?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&rd="+encodeURIComponent(b),!1).then(function(b){I(a.w.win,"xhr").fetch(b)})};var S;function pa(a){var b=window,c=qa();b.addEventListener("message",function(b){try{return a(b)}catch(e){throw self.__AMP_REPORT_ERROR(e),e;}},c?void 0:!1)}function qa(){if(void 0!==S)return S;S=!1;try{var a={get capture(){S=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return S};function T(a){this.D=[];this.T=[];this.U=a;this.L=this.L.bind(this);pa(this.L)}T.prototype.L=function(a){var b=this,c=a.data,d=a.origin===this.U,e="object"===typeof c&&"_scramp"in c,f=-1<this.D.indexOf(a.source);d&&f&&e&&(this.T.forEach(function(a){return a(c)}),this.D.filter(function(b){return b!==a.source}).forEach(function(a){a.postMessage(c,b.U)}))};T.prototype.register=function(a,b){var c=this;b&&this.T.push(b);Promise.resolve(a).then(function(a){-1===c.D.indexOf(a)&&c.D.push(a)})};var U,ra="Webkit webkit Moz moz ms O o".split(" ");function V(a){var b=this;this.C=a;this.h=this.m=this.N=null;this.layout_={width:null,left:null,right:null};this.window=new Promise(function(a){b.N=a})}h=V.prototype;h.el=function(a,b,c){var d=P(this.C.win.document,a,b);Array.isArray(c)&&c.forEach(function(a){return d.appendChild(a)});return d};h.mount=function(){var a=this.m;this.C.getBody().appendChild(a);K(this.C).addToFixedLayer(a)};h.mutate=function(a){I(this.C.win,"vsync").mutate(a)};
h.toggleClass=function(a,b){var c=this.m.classList;b?c.add(a):c.remove(a)};h.updateHorizontalLayout=function(a){var b=this,c=!1;Object.keys(this.layout_).forEach(function(d){if(C.call(a,d)){var e=b.cssSize(a[d]);b.layout_[d]!==e&&(b.layout_[d]=e,c=!0)}});return c};
h.renderHorizontalLayout=function(){var a=this.m,b=this.layout_;"display"in b&&A().error("STYLE","`display` style detected in styles. You must use toggle instead.");for(var c in b){var d=a,e=b[c];var f=d.style;var g=c;if(2>g.length?0:0==g.lastIndexOf("--",0))f=g;else{U||(U=Object.create(null));var l=U[g];if(!l){l=g;if(void 0===f[g]){var k=g;k=k.charAt(0).toUpperCase()+k.slice(1);b:{for(var Q=0;Q<ra.length;Q++){var da=ra[Q]+k;if(void 0!==f[da]){k=da;break b}}k=""}void 0!==f[k]&&(l=k)}U[g]=l}f=l}f&&
((2>f.length?0:0==f.lastIndexOf("--",0))?d.style.setProperty(f,e):d.style[f]=e)}};h.cssSize=function(a){return"number"===typeof a?a+"px":a};function W(a,b,c){V.call(this,a);this.j=b;this.A=c;this.G()}r(W,V);W.prototype.G=function(){var a=this;this.mutate(function(){a.h||(a.K(),a.N(a.h.contentWindow));a.renderHorizontalLayout()})};
W.prototype.K=function(){var a=this;this.h=this.el("iframe",D({scrolling:"no",frameborder:"0",allowtransparency:"true",title:"Scroll",width:"100%",height:"100%",sandbox:"allow-scripts allow-same-origin allow-top-navigation allow-popups allow-popups-to-escape-sandbox"}));this.m=this.el("div",D({"class":"amp-access-scroll-bar"}),[this.h]);this.mount();this.j.buildUrl(this.A+"/html/amp/scrolltab?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&p=1.2&x=QUERY_PARAM(scrollx)",!1).then(function(b){a.h.setAttribute("src",
b)})};W.prototype.update=function(a){this.updateHorizontalLayout(a)&&this.G()};function X(a){V.call(this,a);this.P="Scroll Feature";this.o={url:"",open:!1,title:this.P}}r(X,V);X.prototype.update=function(a){var b=this,c=!1;switch(a._scramp){case "au":c=this.updateHorizontalLayout(a);["open","url","title"].forEach(function(d){C.call(a,d)&&a[d]!==b.o[d]&&(b.o[d]=a[d],c=!0)});break;case "st":["revealed"].forEach(function(d){C.call(a,d)&&a[d]!==b.o[d]&&(b.o[d]=a[d],c=!0)})}c&&this.G(this.o)};
X.prototype.G=function(a){var b=this;this.mutate(function(){b.h||(b.K(),b.N(b.h.contentWindow));b.h.src!==a.url&&b.h.setAttribute("src",a.url);b.renderHorizontalLayout();b.h.setAttribute("title",a.title);var c=b.h,d=a.open;void 0===d&&(d=c.hasAttribute("hidden"));d?c.removeAttribute("hidden"):c.setAttribute("hidden","")})};
X.prototype.K=function(){this.m=this.h=this.el("iframe",D({"class":"amp-access-scroll-sheet",scrolling:"no",frameborder:"0",allowtransparency:"true",title:this.P,sandbox:"allow-scripts allow-same-origin allow-top-navigation allow-popups allow-popups-to-escape-sandbox"}));this.mount()};function sa(a,b){var c=a.getHeadNode(),d=ta(c,ua(c));if(b){var e=a.getRootNode();if(va(e,d))b(d);else var f=setInterval(function(){va(e,d)&&(clearInterval(f),b(d))},4)}}
function ta(a,b){var c=a.__AMP_CSS_SM;c||(c=a.__AMP_CSS_SM=Object.create(null));var d=wa(a,c,"amp-extension=amp-access-scroll-elt");if(d)return d.textContent!==b&&(d.textContent=b),d;var e=(a.ownerDocument||a).createElement("style");e.textContent=b;var f=null;e.setAttribute("amp-extension","amp-access-scroll-elt");b=f=wa(a,c,"amp-runtime");(b=void 0===b?null:b)?a.insertBefore(e,b.nextSibling):a.insertBefore(e,a.firstChild);return c["amp-extension=amp-access-scroll-elt"]=e}
function wa(a,b,c){return b[c]?b[c]:(a=a.querySelector("style["+c+"]"))?b[c]=a:null}
function ua(a){return(a=a.__AMP_CSS_TR)?a(".amp-access-scroll-bar{bottom:0;height:60px;left:auto;right:0px;width:48px}.amp-access-scroll-bar,.amp-access-scroll-sheet{position:fixed;background:transparent;z-index:2147483647}@media (max-width:599px){.amp-access-scroll-sheet{bottom:60px;height:100px;left:0!important;right:0!important;width:100%!important}}@media (min-width:600px){.amp-access-scroll-sheet{bottom:76px;height:56px;left:auto;right:16px;width:475px}}\n/*# sourceURL=/extensions/amp-access-scroll/0.1/amp-access-scroll.css*/"):".amp-access-scroll-bar{bottom:0;height:60px;left:auto;right:0px;width:48px}.amp-access-scroll-bar,.amp-access-scroll-sheet{position:fixed;background:transparent;z-index:2147483647}@media (max-width:599px){.amp-access-scroll-sheet{bottom:60px;height:100px;left:0!important;right:0!important;width:100%!important}}@media (min-width:600px){.amp-access-scroll-sheet{bottom:76px;height:56px;left:auto;right:16px;width:475px}}\n/*# sourceURL=/extensions/amp-access-scroll/0.1/amp-access-scroll.css*/"}
function va(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++)if(c[a].ownerNode==b)return!0;return!1};function Y(a){return"https://connect"+((w().development&&a.etld?a.etld:"")||".scroll.com")}
function Z(a,b){var c=b.getAdapterConfig(),d=Y(c);R.call(this,a,{authorization:d+"/amp/access?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&x=QUERY_PARAM(scrollx)&p=1.2",pingback:d+"/amp/pingback?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&r=DOCUMENT_REFERRER&x=QUERY_PARAM(scrollx)&d=AUTHDATA(scroll)&v=AUTHDATA(visitId)&p=1.2",namespace:"scroll"},{buildUrl:b.buildUrl.bind(b),collectUrlVars:b.collectUrlVars.bind(b)});sa(a,function(){});this.j=b;this.A=d}
r(Z,R);
Z.prototype.authorize=function(){var a=this;return R.prototype.authorize.call(this).then(function(b){var c=a.ampdoc.getRootNode().querySelector("amp-story[standalone]");if(b&&b.scroll){if(!c){var d=new W(a.ampdoc,a.j,a.A),e=new X(a.ampdoc),f=new T(a.A);f.register(e.window,function(a){"au"!==a._scramp&&"st"!==a._scramp||e.update(a)});f.register(d.window,function(a){"st"===a._scramp&&(e.update(a),d.update(a))});var g=a.j.getAdapterConfig();xa(a.ampdoc,g);b.features&&b.features.d&&new na(a.ampdoc,a.j,
Y(g))}}else b&&b.blocker&&!u(a.ampdoc.win.location.search).scrollnoblockerrefresh&&(new ya(a.ampdoc,a.j)).check();return b})};function ya(a,b){this.w=a;this.j=b}
ya.prototype.check=function(){var a=this;I(this.w.win,"xhr").fetchJson("https://block.scroll.com/check.json").then(function(){return!1},function(a){return 0===a.message.indexOf("XHR Failed fetching (https://block.scroll.com/...): Resource blocked by content blocker")}).then(function(b){if(!0===b){var c=Y(a.j.getAdapterConfig()),d=new W(a.w,a.j,c);(new T(c)).register(d.window,function(a){"st"===a._scramp&&d.update(a)})}})};
function xa(a,b){if(!b.disableAnalytics){var c=a.win.document,d=D({trigger:"immediate"});b.dataConsentId&&(d["data-block-on-consent"]="");var e=P(c,"amp-analytics",d),f=P(c,"script",D({type:"application/json"}));c={requests:{scroll:Y(b)+"/amp/analytics?rid=ACCESS_READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&r=DOCUMENT_REFERRER&x=QUERY_PARAM(scrollx)&d=AUTHDATA(scroll.scroll)&v=AUTHDATA(scroll.visitId)&h=SOURCE_HOSTNAME&s=${totalEngagedTime}&p=1.2"},triggers:{trackInterval:{on:"timer",
timerSpec:{interval:15,maxTimerLength:7200},request:"scroll"}}};f.textContent=JSON.stringify(c);e.appendChild(f);e.CONFIG=c;I(a.win,"extensions").installExtensionForDoc(a,"amp-analytics");a.getBody().appendChild(e)}};(function(a){a.registerServiceForDoc("scroll",function(a){var b=a.getHeadNode();return ka(b).then(function(b){var c=b.getVendorSource("scroll"),d=new Z(a,c);c.getAdapter().registerVendor(d);return d})})})(self.AMP);
})});

//# sourceMappingURL=amp-access-scroll-0.1.js.map
