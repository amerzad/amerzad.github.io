(self.AMP=self.AMP||[]).push({n:"amp-vk",v:"2007102309000",f:(function(AMP,_){
var f,g="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function h(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object");})()}h(this);"function"===typeof Symbol&&Symbol("x");var k;
if("function"==typeof Object.setPrototypeOf)k=Object.setPrototypeOf;else{var l;a:{var m={a:!0},n={};try{n.__proto__=m;l=n.a;break a}catch(a){}l=!1}k=l?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var q=k;var r=self.AMP_CONFIG||{},t=("string"==typeof r.cdnProxyRegex?new RegExp(r.cdnProxyRegex):r.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function u(a){if(self.document&&self.document.head&&(!self.location||!t.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}r.cdnUrl||u("runtime-host");r.geoApiUrl||u("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var v=self.__AMP_LOG;function w(){if(!v.user)throw Error("failed to call initLogConstructor");return v.user}function x(a,b,c){return w().assert(a,b,c,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)};function y(a){return a||{}};y({c:!0,v:!0,a:!0,ad:!0,action:!0});function z(a,b){if(!b)return a;var c=a.split("#",2),d=c[0].split("?",2),e=d[0]+(d[1]?"?"+d[1]+"&"+b:"?"+b);return e+=c[1]?"#"+c[1]:""}function A(a){var b=[],c;for(c in a){var d=a[c];if(null!=d)if(Array.isArray(d))for(var e=0;e<d.length;e++){var p=d[e];b.push(encodeURIComponent(c)+"="+encodeURIComponent(p))}else e=d,b.push(encodeURIComponent(c)+"="+encodeURIComponent(e))}return b.join("&")};function B(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return C(a,b)}function D(a){var b=E(a);b=E(b);b=b.isSingleDoc()?b.win:b;return C(b,"viewer")}function E(a){return a.nodeType?B((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function C(a,b){var c=a.__AMP_SERVICES;c||(c=a.__AMP_SERVICES={});a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
var G;function H(a,b){var c=a,d=b;var e=function(a){try{return d(a)}catch(F){throw self.__AMP_REPORT_ERROR(F),F;}};var p=I();c.addEventListener("message",e,p?void 0:!1);return function(){c&&c.removeEventListener("message",e,p?void 0:!1);e=c=d=null}}function I(){if(void 0!==G)return G;G=!1;try{var a={get capture(){G=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return G};function J(a,b){return H(a,b)};var K={POST:"post",POLL:"poll"};function L(a){a=AMP.BaseElement.call(this,a)||this;a.j=null;a.C=0;a.l=null;a.h=null;a.w=null;a.B=null;a.o=null;a.m=null;a.A=null;return a}var M=AMP.BaseElement;L.prototype=g(M.prototype);L.prototype.constructor=L;if(q)q(L,M);else for(var N in M)if("prototype"!=N)if(Object.defineProperties){var O=Object.getOwnPropertyDescriptor(M,N);O&&Object.defineProperty(L,N,O)}else L[N]=M[N];L.F=M.prototype;f=L.prototype;
f.preconnectCallback=function(a){B(this.win,"preconnect").url(this.getAmpDoc(),"https://vk.com",a)};function P(a){var b=Date.now().toString(16),c;"post"===a.h?c=Q(a):"poll"===a.h&&(c=R(a));return c.then(function(a){return z(a,b)})}
function Q(a){return D(a.element).getReferrerUrl().then(function(b){var c=a.element.offsetWidth,d=a.getAmpDoc().getUrl(),e=y({app:"0",width:"100%",_ver:"1",owner_id:a.w,post_id:a.B,hash:a.o,amp:"1",startWidth:c,url:d,referrer:b,title:"AMP Post"});return z("https://vk.com/widget_post.php",A(e))})}
function R(a){return D(a.element).getReferrerUrl().then(function(b){var c=a.getAmpDoc().getUrl();b=y({app:a.m,width:"100%",_ver:"1",poll_id:a.A,amp:"1",url:c,title:"AMP Poll",description:"",referrer:b});return z("https://vk.com/al_widget_poll.php",A(b))})}
f.buildCallback=function(){this.h=x(this.element.getAttribute("data-embedtype"),"The data-embedtype attribute is required for <amp-vk> %s",this.element);w().assertEnumValue(K,this.h,"data-embedtype");"post"===this.h?(this.w=x(this.element.getAttribute("data-owner-id"),"The data-owner-id attribute is required for <amp-vk> Post %s",this.element),this.B=x(this.element.getAttribute("data-post-id"),"The data-post-id attribute is required for <amp-vk> Post %s",this.element),this.o=x(this.element.getAttribute("data-hash"),
"The data-hash attribute is required for <amp-vk> Post %s",this.element)):"poll"===this.h&&(this.m=x(this.element.getAttribute("data-api-id"),"The data-api-id attribute is required for <amp-vk> Poll %s",this.element),this.A=x(this.element.getAttribute("data-poll-id"),"The data-poll-id attribute is required for <amp-vk> Poll %s",this.element))};
f.layoutCallback=function(){var a=this,b=this.element.ownerDocument.createElement("iframe");this.j=b;this.l=J(this.win,this.D.bind(this));return P(this).then(function(c){b.src=c;b.setAttribute("name","fXD");b.setAttribute("scrolling","no");b.setAttribute("frameborder","0");b.setAttribute("allowfullscreen","true");a.applyFillContent(b);a.element.appendChild(b);return a.loadPromise(b)})};
f.D=function(a){if("https://vk.com"===a.origin&&a.source===this.j.contentWindow){var b=a.data;if(b&&(a=/\["resize",\[(\d+)\]]/.exec(b))&&a[1]){var c=parseInt(a[1],10);this.C!==c&&(this.C=c,this.forceChangeHeight(c))}}};f.isLayoutSupported=function(a){return"responsive"===a||"flex-item"===a||"fixed"===a};f.unlayoutOnPause=function(){return!0};f.unlayoutCallback=function(){if(this.j){var a=this.j;a.parentElement&&a.parentElement.removeChild(a);this.j=null}this.l&&this.l();return!0};
(function(a){a.registerElement("amp-vk",L)})(self.AMP);
})});

//# sourceMappingURL=amp-vk-0.1.js.map
